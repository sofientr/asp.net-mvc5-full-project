<link href="~/Content/bootstrap-datepicker3.min.css" rel="stylesheet" type="text/css" />
<link href="~/Content/select2.min.css" rel="stylesheet" type="text/css" />
<link href="~/Content/plugins/awesome-bootstrap-checkbox/awesome-bootstrap-checkbox.css" rel="stylesheet" type="text/css" />
<link href="~/Content/plugins/switchery/switchery.css" rel="stylesheet" type="text/css" />
<style type="text/css">
    input[type=number]::-webkit-inner-spin-button, input[type=number]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }

    #Tableau {
        width: 2000px;
    }

    #Tab {
        width: 1500px;
    }
</style>
<style>
    .divScroll {
        overflow: auto;
    }
</style>

<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-10">
        <h2>
            BON LIVRAISONS Partiel CLIENTS
        </h2>
        <ol class="breadcrumb">
            <li><a>Vente</a> </li>
            <li class="active">
                @if ((ViewBag.Mode == "Edit") || (ViewBag.Mode == "Editcmd"))
                {
                    <strong>Modifier un bon de livraison Partiel </strong>
                }
                @if (ViewBag.Mode == "Create")
                {
                    <strong>Nouveau bon de livraison Partiel</strong>
                }
                @if (ViewBag.Mode == "Aff")
                {
                    <strong>Afficher un bon de livraison Partiel</strong>
                }
            </li>
        </ol>
    </div>
    <div class="col-lg-2">
    </div>
</div>
<div class="wrapper wrapper-content animated fadeInRight">
    @using (Html.BeginForm("SendBonLivraisonPart", "Vente", new { Mode = ViewBag.Mode, Code = ViewBag.Code }, FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
    {
    <div class="row" style="margin-bottom: 20px; margin-right: 0px;">
        @*<input type="checkbox" class="js-switch" checked style="display: none;" data-switchery="true" id="chec" onclick="aff();">*@
        <input type="hidden" class="js-switch js-check-change" checked="" data-switchery="true" style="display: none;" > 
        @*<div class="check-change js-check-change-field"></div>*@
        @*<label id="bl" class="col-lg-2 control-label">
            Bon livraison total
        </label>*@

        <button class="btn btn-primary pull-right" type="submit" id="Enregistre">
            <span class="bold">Enregistrer</span>
        </button>
        <button class="btn btn-warning pull-right" type="button" style="margin-right: 5px;"
                id="DeleteBtn" onclick="Delete();">
            <span class="bold">Supprimer</span>
        </button>
        <button class="btn btn-success pull-right" type="button" style="margin-right: 5px;" @if (ViewBag.Mode == "Create") { @: disabled
                }
                id="PrintBTN">
            <span class="bold">Imprimer</span>
        </button>
        <div class="btn-group pull-right" style="margin-right: 5px;">
            <button data-toggle="dropdown" id="Transformer" class="btn btn-default dropdown-toggle" @if (ViewBag.Mode == "Create" || ViewBag.EnEcours != null || ViewBag.EnEcours1 != null) { @: disabled
                    }>
                Transformer <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
                <li id="VersFacture" onclick="VersFacture();"><a href="#">Facture client</a></li>
                <li id="VersCaisse" onclick="VersCaisse();"><a href="#">Caisse Noire</a></li>
            </ul>
        </div>
        <div class="btn-group pull-right" style="margin-right: 5px;">
            <button data-toggle="dropdown" id="PL" class="btn btn-default dropdown-toggle" @if (ViewBag.Mode == "Create") { @: disabled
                    }>
                Pièces Liées <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
                @if (Model.COMMANDES_CLIENTS != null)
                {
                    <li><a href="/Vente/FormCommande?Mode=Edit&Code=@Model.COMMANDES_CLIENTS.ID">@Model.COMMANDES_CLIENTS.CODE</a></li>
                }
            </ul>
        </div>
        @if ((ViewBag.Mode == "Edit") || (ViewBag.Mode == "Editcmd"))
        {
            if (ViewBag.Valider == true)
            {
                <button class="btn btn-primary dim pull-right" type="button" title="Validée" disabled
                        style="height: 28px; padding-bottom: 3px; padding-top: 3px;">
                    <i class="fa fa-check"></i>
                </button>
            }
            else
            {
                if (Model.VALIDER == false)
                {
                    <button class="btn btn-primary dim pull-right" type="button" title="Validée" style="height: 28px;
                    padding-bottom: 3px; padding-top: 3px;" id="ValidateBtn" onclick="Validate();">
                        <i class="fa fa-check"></i>
                    </button>
                }
                else
                {
                    <button class="btn btn-primary dim pull-right" type="button" title="Validée" disabled
                            style="height: 28px; padding-bottom: 3px; padding-top: 3px;">
                        <i class="fa fa-check"></i>
                    </button>
                }
            }
        }
        else
        {
            <button class="btn btn-warning dim pull-right" type="button" disabled title="Validée"
                    style="height: 28px; padding-bottom: 3px; padding-top: 3px;">
                <i class="fa fa-check"></i>
            </button>
        }

        <div class="form-group">

            @*<div class="col-sm-10">
                     <label class="radio-inline">
                         <input type="radio" id="choix1" name="type" value="Totale" onclick="func();" /><label>Totale</label>
                     </label>
                     <label class="radio-inline">
                         <input type="radio" id="choix2" name="type" value="Partielle" onclick="func();" /><label>Partielle</label>
                     </label>
            </div>*@

        </div>

    </div>
        <div class="row">
            <div class="col-lg-6">
                <div class="form-group">
                    <label class="col-lg-2 control-label" style="text-align: initial;">
                        NUMERO
                    </label>
                    <div class="col-lg-10">
                        <input type="text" class="form-control" readonly="true" name="numero" id="numero" value="@ViewBag.Numero" required>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="form-group">
                    <label class="col-lg-2 control-label" style="text-align: initial;">
                        DATE
                    </label>
                    <div class="col-lg-10">
                        <div class="input-group date">
                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            <input type="text" class="form-control" name="date" id="date" required>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-6">
                <div class="form-group">
                    <label class="col-lg-2 control-label" style="padding-left: 0px; text-align: initial;">
                        DESIGNATION
                    </label>
                    <div class="col-lg-10">
                        <input type="text" class="form-control" name="designation" id="designation">
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="form-group">
                    <label class="col-lg-2 control-label" style="padding-left: 0px; text-align: initial;" hidden>
                        TYPE
                    </label>
                    <div class="col-lg-10">
                        <input type="hidden" class="form-control" @*readonly="true"*@ name="type" id="type" value="true">
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="form-group">
                    <label class="col-lg-2 control-label" style="text-align: initial;">
                        PAIEMENT
                    </label>
                    <div class="col-lg-10">
                        <select class="form-control" name="modePaiement" id="modePaiement" required>
                            <option value=""></option>
                            <option value="Chèque">Chèque</option>
                            <option value="Espèce">Espèce</option>
                            <option value="Virement bancaire">Virement bancaire</option>
                            <option value="Carte bancaire">Carte bancaire</option>
                            <option value="A terme">A terme</option>
                            <option value="Traite">Traite</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-6">
                <div class="form-group">
                    <label class="col-lg-2 control-label" style="padding-left: 0px; text-align: initial;">
                        CLIENT
                    </label>
                    <div class="col-lg-10">
                        <select class="form-control" name="client" id="client" required></select>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="form-group">
                    <label class="col-lg-2 control-label" style="padding-left: 0px; text-align: initial;">
                        CODE
                    </label>
                    <div class="col-lg-10">
                        <input type="text" class="form-control" readonly="true" name="codeClient" id="codeClient"
                               required>
                    </div>
                </div>
            </div>
            @*<div class="col-lg-6">
                    <div class="form-group">
                        <label class="col-lg-2 control-label" style="padding-left: 0px; text-align: initial;">
                            SOCIETE
                        </label>
                        <div class="col-lg-10">
                            <select class="form-control" name="Societes" id="Societes"></select>
                        </div>
                    </div>
                </div>*@
            <div class="col-lg-6">
                <div class="form-group">
                    <label class="col-lg-2 control-label" style="padding-left: 0px; text-align: initial;">
                        TIERS
                    </label>
                    <div class="col-lg-10">
                        <select class="form-control" id="Tiers" name="Tiers"><option>---SelectTiers---</option></select>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="form-group">
                    <label class="col-lg-2 control-label" style="padding-left: 0px; text-align: initial;">
                        REMISE %
                    </label>
                    <div class="col-lg-10">
                        <input type="text" class="form-control" name="remise" id="remise" value="0" min="0" required>
                    </div>
                </div>
            </div>

        </div>
        @*<input type="hidden" name="WithPrint" id="WithPrint" required />*@
        @*<div id='myModal' class='modal'>
            <div class="modal-dialog">
                <div class="modal-content">
                    <div id='myModalContent'>

                    </div>
                </div>
            </div>

        </div>*@
        <div class="row">

        </div>

        <div class="hr-line-dashed">
        </div>
        <div class="row">
            <div class="col-lg-10">
                <strong>Totaux</strong>
            </div>
            <div class="col-lg-2">
            </div>
        </div>
        <div class="form-group">
            <label class="col-lg-2 control-label">
                TOTAL HT
            </label>
            <div class="col-lg-4">
                <input type="text" class="form-control" readonly="true" name="totalHT" id="totalHT">
            </div>
            <label class="col-lg-2 control-label">
                NET HT
            </label>
            <div class="col-lg-4">
                <input type="text" class="form-control" readonly="true" name="NetHT" id="NetHT">
            </div>
        </div>
        <div class="form-group">
            <label class="col-lg-2 control-label">
                TOTAL TVA
            </label>
            <div class="col-lg-4">
                <input type="text" class="form-control" readonly="true" name="totalTVA" id="totalTVA">
            </div>
            <label class="col-lg-2 control-label">
                TOTAL TTC
            </label>
            <div class="col-lg-4">
                <input type="text" class="form-control" readonly="true" name="TotalTTC" id="TotalTTC">
            </div>
        </div>
        <div class="form-group">
            <label class="col-lg-2 control-label">
            </label>
            <div class="col-lg-4">
            </div>
            <label class="col-lg-2 control-label">
                NET A PAYE
            </label>
            <div class="col-lg-4">
                <input type="text" class="form-control" readonly="true" name="netAPaye" id="netAPaye"
                       style="font-size: x-large;">
            </div>
        </div>
        <input type="hidden" name="WithPrint" id="WithPrint" />
        <div class="hr-line-dashed">
        </div>
        <div class="row">
            <div class="col-lg-10">
                <strong>Lignes</strong>
            </div>
            <div class="col-lg-2">
            </div>
        </div>
        <div class="divScroll">
            <table class="table table-striped table-bordered table-hover dataTables-example"
                   id="Tableau">
                <thead>
                    <tr>
                        <th style="width:150px;">
                            ARTICLE
                        </th>
                        <th>
                            DESCRIPTION
                        </th>
                        <th style="width:150px;">
                            MARQUE
                        </th>
                        <th style="width:150px;">
                            UNITE
                        </th>
                        <th style="width:150px;">
                            DEVISE
                        </th>
                        <th style="width:150px;">
                            CATEGORIE
                        </th>
                        <th style="width:150px;">
                            SOUS_CATEGORIE
                        </th>
                        <th>
                            STOCK
                        </th>
                        <th style="width:80px;">
                            QTE
                        </th>
                        <th>
                            QTE LIV
                        </th>
                        <th>
                            QTE Res
                        </th>
                        <th>
                            PUHT
                        </th>
                        <th>
                            REMISE
                        </th>
                        <th>
                            PTHT
                        </th>
                        <th style="width:90px;">
                            TVA
                        </th>
                        <th>
                            TTC
                        </th>
                        <th>

                        </th>
                    </tr>
                </thead>
                <tbody></tbody>
                <tfoot>
                    <tr>
                        <td>
                            <select class="form-control" id="articles"></select>
                        </td>
                        @*<td>
                                <input type="text" class="form-control" id="descriptionProduit" />
                            </td>*@
                        <td>
                            <textarea id="descriptionProduit">
                            </textarea>
                        </td>
                        <td>
                            <select class="form-control" id="marque"></select>
                        </td>
                        <td>
                            <select class="form-control" id="unite"></select>
                        </td>
                        <td>
                            <select class="form-control" id="devise"></select>
                        </td>
                        <td>
                            <select class="form-control" id="categorie"></select>
                        </td>
                        <td>
                            <select id="Sous_Categorie" name="Sous_Categorie" style="width:140px; height:35px;"><option>---Select Categorie---</option></select>
                        </td>
                        <td>
                            <input type="text" class="form-control" id="StockProduit" readonly="true" />
                        </td>
                        <td>
                            <input type="number" class="form-control" id="QuantiteProduit" value="1" min="1" />
                        </td>
                        <td>
                            <input type="number" class="form-control" id="QuantiteLiv" value="1" min="0" disabled required />
                        </td>
                        <td>
                            <input type="number" class="form-control" id="QuantiteRes" value="0" min="0" disabled />
                        </td>
                        <td>
                            <input type="number" class="form-control" id="PUHTProduit" min="0" />
                        </td>
                        <td>
                            <input type="number" class="form-control" id="RemiseProduit" value="0" min="0" />
                        </td>

                        <td>
                            <input type="number" class="form-control" id="PTHTProduit" readonly="true" />
                        </td>
                        @*<td>
                            <input type="number" class="form-control" id="TVAProduit" min="0" />
                            </td>*@
                        <td>
                            <select class="form-control" id="TVAProduit"></select>
                        </td>
                        <td>
                            <input type="number" class="form-control" id="TTCProduit" readonly="true" />
                        </td>
                        <td style="display: flex; border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px;
                        border-top-width: 0px;">
                            <button class="btn btn-info btn-circle" type="button" onclick="AddRow()" id="FirstBTN"
                                    disabled>
                                <i class="fa fa-check"></i>
                            </button>
                            <button class="btn btn-warning btn-circle" type="button" disabled>
                                <i class="fa fa-times"></i>
                            </button>
                        </td>
                    </tr>
                </tfoot>
            </table>
        </div>
        if ((ViewBag.Mode == "Edit") || (ViewBag.Mode == "Aff") || (ViewBag.Mode == "Editcmd") || (ViewBag.Mode == "Create"))
        {
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>Services</h5>
                    <span class="label label-primary">S</span>
                    <div class="ibox-tools">
                        <a class="collapse-link">
                            <i class="fa fa-chevron-up"></i>
                        </a>


                    </div>

                </div>
                <div class="ibox-content">

                    <div>
                        <div class="divScroll">

                            <table class="table table-striped table-bordered table-hover dataTables-example" id="Tab">
                                <thead>
                                    <tr>

                                        <th style="width:160px;">
                                            REF_SERVICE
                                        </th>
                                        <th>
                                            DES_SERVICE
                                        </th>
                                        <th>
                                            UNITE
                                        </th>
                                        <th>
                                            QTE
                                        </th>

                                        <th>
                                            PUHT
                                        </th>
                                        <th>
                                            REMISE
                                        </th>
                                        <th>
                                            PTHT
                                        </th>
                                        <th style="width:90px;">
                                            TVA
                                        </th>
                                        <th>
                                            PTTC
                                        </th>
                                        <th style="width:200px;">
                                            RESSOURCES
                                        </th>

                                        <th>
                                        </th>

                                    </tr>
                                    <tr>
                                        <th colspan="8" style="text-align:right">Coût services:</th>
                                        <th><input type="text" class="form-control" readonly="true" name="NettotalTTCSERV" id="NettotalTTCSERV" value="0" required></th>
                                        <th></th>
                                    </tr>
                                </thead>

                                <tbody></tbody>
                                <tfoot>
                                    <tr>
                                        <td>
                                            <select type="text" class="form-control" id="SERVICE" />
                                        </td>
                                        <td>
                                            <textarea id="descriptionSERVICE">
                                        </textarea>
                                        </td>
                                        <td>
                                            <input class="form-control" id="uniteSERVICE" value="H" />
                                        </td>
                                        <td>
                                            <input type="number" class="form-control" id="QuantiteSERVICE" value="1" min="1"/>
                                        </td>
                                        <td>
                                            <input type="number" class="form-control" id="PUHTSERVICE" min="0" />
                                        </td>
                                        <td>
                                            <input type="number" class="form-control" id="RemiseSERVICE" value="0" min="0" />
                                        </td>
                                        <td>
                                            <input type="number" class="form-control" id="PTHTSERVICE" readonly="true" />
                                        </td>
                                        <td>
                                            <select class="form-control" id="TVASERVICE"><option>19</option></select>
                                        </td>
                                        <td>
                                            <input type="number" class="form-control" id="TTCSERVICE" readonly="true" />

                                        </td>
                                        <td>

                                            <select type="text" id="RESSOURCE" data-placeholder="Choose a Country..." class="chosen-select" multiple style="width:350px;" tabindex="4"></select>

                                        </td>
                                        <td style="display: flex; border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px;
                                            border-top-width: 0px;" required>
                                            <button class="btn btn-info btn-circle" type="button" onclick="AddRow2()" id="FirstBTN2">
                                                <i class="fa fa-check"></i>
                                            </button>
                                            <button class="btn btn-warning btn-circle" type="button" disabled>
                                                <i class="fa fa-times"></i>
                                            </button>
                                        </td>
                                    </tr>

                                </tfoot>

                            </table>

                        </div>

                    </div>
                </div>

            </div>
        }
    }
</div>
@section Styles {
    @Styles.Render("~/Content/plugins/dataTables/dataTablesStyles")
    @Styles.Render("~/plugins/sweetAlertStyles")
    @Styles.Render("~/plugins/awesomeCheckboxStyles")
    @Styles.Render("~/plugins/clockpickerStyles")
    @Styles.Render("~/plugins/dateRangeStyles")
    @Styles.Render("~/Content/plugins/iCheck/iCheckStyles")
    @Styles.Render("~/Content/plugins/chosen/chosenStyles")
    @Styles.Render("~/plugins/switcheryStyles")
    @Styles.Render("~/plugins/jasnyBootstrapStyles")
    @Styles.Render("~/plugins/nouiSliderStyles")
    @Styles.Render("~/plugins/dataPickerStyles")
    @Styles.Render("~/Content/plugins/ionRangeSlider/ionRangeStyles")
    @Styles.Render("~/plugins/imagecropperStyles")
    @Styles.Render("~/Content/plugins/colorpicker/colorpickerStyles")
    @Styles.Render("~/plugins/select2Styles")
    @Styles.Render("~/plugins/touchSpinStyles")
}
@section Scripts {
    <script src="~/js/bootstrap-datepicker.min.js" type="text/javascript"></script>
    <script src="~/js/select2.min.js" type="text/javascript"></script>
    @Scripts.Render("~/plugins/select2")
    @Scripts.Render("~/plugins/dataPicker")
    @Scripts.Render("~/plugins/dataTables")
    @Scripts.Render("~/plugins/switchery")
    @Scripts.Render("~/plugins/iCheck")
    @Scripts.Render("~/plugins/sweetAlert")
    @Scripts.Render("~/plugins/ionRange")
    @Scripts.Render("~/plugins/nouiSlider")
    @Scripts.Render("~/plugins/jasnyBootstrap")
    @Scripts.Render("~/plugins/chosen")
    @Scripts.Render("~/plugins/knob")
    @Scripts.Render("~/plugins/imagecropper")
    @Scripts.Render("~/plugins/colorpicker")
    @Scripts.Render("~/plugins/clockpicker")
    @Scripts.Render("~/plugins/dateRange")
    @Scripts.Render("~/plugins/touchSpin")
    <script type="text/javascript">
        $(document).ready(function () {
            $("#Li-Vente").attr("class", "active");
            $("#ul-Vente").attr("class", "nav nav-second-level collapse in");
            $("#ul-Vente").attr("aria-expanded", "true");
            var elem = document.querySelector('.js-switch');
            var switchery = new Switchery(elem, { color: '#1AB394' });
            $('.i-checks').iCheck({
                checkboxClass: 'icheckbox_square-green',
                radioClass: 'iradio_square-green'
            });
            var changeCheckbox = document.querySelector('.js-check-change');
            //, changeField = document.querySelector('.js-check-change-field');

            changeCheckbox.onchange = changeCheckbox.checked;

            RemplirListe();
            RemplirListe2();
            RemplirListe3();
            RemplirListe4();
            RemplirListe5();
            RemplirListe6();
            RemplirListe11();
            RemplirListe12();
            RemplirListe13();
            $("#date").datepicker({
                format: 'dd/mm/yyyy'
            });
            $("#fournisseur").select2();
            $("#articles").select2();
            $("#societe").select2();
            $("#SERVICE").select2();
            $("#RESSOURCE").select2();
            $("#TVASERVICE").select2();
            var Mode = "@ViewBag.Mode";
            var client = "@Model.CLIENT";
            //var Societes = "@Model.Societes";
            //var Type1 = "@ViewBag.Type";
            //******************************************************************
            $('#SERVICE').append($('<option>', {
                value: "",
                text: ""
            }));
            $.ajax({
                type: 'POST',
                url: "/Vente/GetAllSERVICE",
                success: function (response) {
                    $.each(response, function (i, item) {
                        $('#SERVICE').append($('<option>', {
                            value: item.ID,
                            text: item.NOM
                        }));
                        //if (Mode == "Edit") {
                        //    $("#SERVICE").val(fournisseur).trigger("change");
                        //}
                        //if (Mode == "Aff") {
                        //    $("#SERVICE").val(fournisseur).trigger("change");
                        //}
                    });
                }
            });
            $('#RESSOURCE').append($('<option>', {
                value: "",
                text: ""
            }));
            $.ajax({
                type: 'POST',
                url: "/Vente/GetAllRESSOURCE",
                success: function (response) {
                    $.each(response, function (i, item) {
                        $('#RESSOURCE').append($('<option>', {
                            value: item.PersonnelId,
                            text: item.Nom
                        }));

                    });
                }
            });
            $('#client').append($('<option>', {
                value: "",
                text: ""
            }));
            $.ajax({
                type: 'POST',
                url: "/Vente/GetAllClient",
                success: function (response) {
                    $.each(response, function (i, item) {
                        $('#client').append($('<option>', {
                            value: item.ID,
                            text: item.NOM
                        }));
                        if (Mode == "Edit") {
                            $("#client").val(client).trigger("change");
                        }
                        if (Mode == "Editcmd") {
                            $("#client").val(client).trigger("change");
                        }
                        if (Mode == "Aff") {
                            $("#client").val(client).trigger("change");
                        }
                    });
                }
            });
            //------------------------------------------------
            //$('#Societes').append($('<option>', {
            //    value: "",
            //    text: ""
            //}));

            //$.ajax({
            //    type: 'POST',
            //    url: "/Vente/GetAllSocietes",
            //    success: function (response) {

            //        $.each(response, function (i, item) {
            //            $('#Societes').append($('<option>', {
            //                value: item.SociID,
            //                text: item.NOM

            //            }));

            //            if (Mode == "Edit") {
            //                $("#Societes").val(Societes).trigger("change");
            //            }
            //            if (Mode == "Editcmd") {
            //                $("#Societes").val(Societes).trigger("change");
            //            }
            //            if (Mode == "Aff") {
            //                $("#Societes").val(Societes).trigger("change");
            //            }
            //        });
            //    }
            //});
            //--------------------------------------------------------------------------
            //$(document).on("change", "#Societes", function (e) {
            //    //$('#Societes').on('change', function () {
            //    $("#codeSoc").val("");
            //    if (this.value != "") {
            //        $.ajax({
            //            type: 'POST',
            //            url: "/Vente/GetSocByID?ID=" + this.value,
            //            success: function (response) {
            //                $("#codeSoc").val(response.CODE_ACCES);
            //            }
            //        });
            //    }
            //});
            //*****************************************************************************************************
            $("#client").change(function () {

                var selectedItemValue = $(this).val();

                var ddlProducts = $("#Tiers");
                $.ajax({
                    cache: false,
                    type: "GET",
                    url: '@Url.Action("GetTiersBySocietesId", "Vente")',
                    data: { "id": selectedItemValue },
                    success: function (data) {
                        ddlProducts.html('');
                        $.each(data, function (id, option) {
                            ddlProducts.append($('<option></option>').val(option.id).html(option.name));
                        });
                    },
                    //error: function (xhr, ajaxOptions, thrownError) {
                    //alert('Found error to load product!!.');
                    //}
                });
            });
            //    $("#Societes").change(function () {

            //        var selectedItemValue = $(this).val();

            //        var ddlProducts = $("#Tiers");
            //        $.ajax({
            //            cache: false,
            //            type: "GET",
            //            url: '@Url.Action("GetTiersBySocietesId", "Vente")',
            //            data: { "id": selectedItemValue },
            //            success: function (data) {
            //                ddlProducts.html('');
            //                $.each(data, function (id, option) {
            //                    ddlProducts.append($('<option></option>').val(option.id).html(option.name));
            //                });
            //            },

            //        });
            //});

            //**************************** CHANGE TVA******************

            $(document).on("change", "#TVAProduit", function (e) {

                var Qte = $("#QuantiteProduit").val();
                Qte = parseFloat(Qte);
                var PRIX_VENTE_HT = parseFloat($('#PUHTProduit').val());
                var PrixTotHTSansRemise = Qte * PRIX_VENTE_HT;
                var Remise = $("#RemiseProduit").val();
                Remise = parseFloat(Remise);
                var MontantRemise = (PrixTotHTSansRemise * Remise) / 100;
                var PTHTProduit = PrixTotHTSansRemise - MontantRemise;

                $('#PTHTProduit').val(PTHTProduit.toFixed(3));
                var TVA = $(this).val();
                TVA = parseFloat(TVA);
                var MontantTVA = (PTHTProduit * TVA) / 100;
                var TTCProduit = PTHTProduit + MontantTVA;

                $('#TTCProduit').val(TTCProduit.toFixed(3));

            });
            $(document.querySelector('.js-check-change')).change(function () {
                if (document.querySelector('.js-check-change').checked) {
                    Type1 = true;
                    $("#type").val(true);
                    $('#bl').text('Bon livraison total');
                    debugger;
                    document.getElementById('QuantiteLiv').disabled = true;
                    var Qte = $("#QuantiteProduit").val();
                    qte = parseFloat(Qte);
                    $('#QuantiteLiv').val(qte);
                    var PRIX_VENTE_HT = parseFloat($('#PUHTProduit').val());
                    var PrixTotHTSansRemise = qte * PRIX_VENTE_HT;
                    var Remise = $("#RemiseProduit").val();
                    Remise = parseFloat(Remise);
                    var MontantRemise = (PrixTotHTSansRemise * Remise) / 100;
                    var PTHTProduit = PrixTotHTSansRemise - MontantRemise;
                    $('#PTHTProduit').val(PTHTProduit.toFixed(3));
                    var TVA = $('#TVAProduit').val();
                    TVA = parseFloat(TVA);
                    var MontantTVA = (PTHTProduit * TVA) / 100;
                    var TTCProduit = PTHTProduit + MontantTVA;
                    $('#TTCProduit').val(TTCProduit.toFixed(3));


                }
                if (document.querySelector('.js-check-change').checked == false) {
                    $("#type").val(false);
                    $('#bl').text('Bon livraison Partiel');
                    Type1 = false;

                    document.getElementById('QuantiteLiv').disabled = false;



                }
                RemplirTableau();
            });
            if (Mode == "Create") {
                $("#DeleteBtn").attr("disabled", true);
                $("#type").val(true);
            }
            if (Mode == "Edit") {
                RemplirTableau4();
                var Type1 = "@Model.Type";
                //if (Type1 != "") {
                //    $("#type").val(Type1);
                //}
                //if (Type1 == "false") {

                //    document.querySelector('.js-check-change').checked = false;
                //    document.querySelector('.js-check-change').onchange = false;

                //}
                //if (Type1 == "true") {

                //    document.querySelector('.js-check-change').checked = true;
                //    document.querySelector('.js-check-change').onchange = true;

                //}
                var designation = decodeHtml("@Model.Designation");
                $("#designation").val(designation);
                var typenew = "@Model.Type";
                var remise = "@Model.REMISE";
                $("#remise").val(parseFloat(remise.replace(",", ".")));
                var codeFournisseur = "@ViewBag.CODE_FOURNISSEUR";
                var date = "@Model.DATE";
                date = date.replace(" 00:00:00", "");
                var modePaiement = "@Model.MODE_PAIEMENT";
                modePaiement = modePaiement.replace("&#232;", "è");
                modePaiement = modePaiement.replace("&#233;", "é");
                $("#date").val(date);
                //
                @*var totalHT = "@Model.THT";
                var NetHT = "@Model.NHT";
                var totalTVA = "@Model.TTVA";
                var TotalTTC = "@Model.TTC";
                var netAPaye = "@Model.TNET";*@
                  var totalHT = ("@Model.THT").replace(",", ".");
            var NetHT = ("@Model.NHT").replace(",", ".");
            var totalTVA = ("@Model.TTVA").replace(",", ".");
            var TotalTTC = ("@Model.TTC").replace(",", ".");
            var netAPaye = ("@Model.TNET").replace(",", ".");

                totalHT = parseFloat(totalHT);
                NetHT = parseFloat(NetHT);
                totalTVA = parseFloat(totalTVA);
                TotalTTC = parseFloat(TotalTTC);
                netAPaye = parseFloat(netAPaye);

                $("#type").val(Type1);
                $("#totalHT").val(totalHT.toFixed(3));
                $("#NetHT").val(NetHT.toFixed(3));
                $("#totalTVA").val(totalTVA.toFixed(3));
                $("#TotalTTC").val(TotalTTC.toFixed(3));
                $("#netAPaye").val(netAPaye.toFixed(3));
                $("#client").val(client).trigger("change");
                $("#codeClient").val(codeClient);
                $("#modePaiement option").each(function (i, item) {
                    if ($(this).attr("value") == modePaiement) {
                        $(this).attr("selected", true);
                    }
                });
                RemplirTableau();
                //RemplirTableau4();



            }
            if (Mode == "Editcmd") {
                RemplirTableau4();
                var Type1 = true;

                //if (Type1 == "False") {

                //    document.querySelector('.js-check-change').checked = false;
                //    document.querySelector('.js-check-change').onchange = false;





                //}
                //if (Type1 == "True") {

                //    document.querySelector('.js-check-change').checked = true;
                //    document.querySelector('.js-check-change').onchange = true;

                //}
                var remise = "@Model.REMISE";
                var designation = decodeHtml("@Model.Designation");
                $("#designation").val(designation);
                //var typenew="@Model.Type";
                $("#remise").val(parseFloat(remise.replace(",", ".")));
                var codeFournisseur = "@ViewBag.CODE_FOURNISSEUR";
                var codeFournisseur = "@ViewBag.CODE_FOURNISSEUR";
                var date = "@Model.DATE";
                date = date.replace(" 00:00:00", "");
                var modePaiement = "@Model.MODE_PAIEMENT";
                modePaiement = modePaiement.replace("&#232;", "è");
                modePaiement = modePaiement.replace("&#233;", "é");
                $("#date").val(date);
                //
                @*var totalHT = "@Model.THT";
                var NetHT = "@Model.NHT";
                var totalTVA = "@Model.TTVA";
                var TotalTTC = "@Model.TTC";
                var netAPaye = "@Model.TNET";*@
                  var totalHT = ("@Model.THT").replace(",", ".");
            var NetHT = ("@Model.NHT").replace(",", ".");
            var totalTVA = ("@Model.TTVA").replace(",", ".");
            var TotalTTC = ("@Model.TTC").replace(",", ".");
            var netAPaye = ("@Model.TNET").replace(",", ".");

                totalHT = parseFloat(totalHT);
                NetHT = parseFloat(NetHT);
                totalTVA = parseFloat(totalTVA);
                TotalTTC = parseFloat(TotalTTC);
                netAPaye = parseFloat(netAPaye);

                $("#type").val(Type1);
                $("#totalHT").val(totalHT.toFixed(3));
                $("#NetHT").val(NetHT.toFixed(3));
                $("#totalTVA").val(totalTVA.toFixed(3));
                $("#TotalTTC").val(TotalTTC.toFixed(3));
                $("#netAPaye").val(netAPaye.toFixed(3));
                $("#client").val(client).trigger("change");
                $("#codeClient").val(codeClient);
                $("#modePaiement option").each(function (i, item) {
                    if ($(this).attr("value") == modePaiement) {
                        $(this).attr("selected", true);
                    }
                });
                RemplirTableau();



            }
            if (Mode == "Aff") {
                RemplirTableau4();
                //$("#Enregistre").attr("disabled", true);
                ////$("#Transformer").attr("disabled", true);
                ////$("#PL").attr("disabled", true);
                ////$("#DeleteBtn").attr("disabled", true);
                document.getElementById('date').disabled = true;
                document.getElementById('client').disabled = true;
                //document.getElementById('Societes').disabled = true;
                document.getElementById('Tiers').disabled = true;
                document.getElementById('modePaiement').disabled = true;

                document.getElementById('remise').disabled = true;
                document.getElementById('designation').disabled = true;



                //var Type = @*"@ViewBag.Type";*@
                //if (Type == "False") {
                //    debugger;
                //    document.querySelector('.js-check-change').checked = false;
                //    (document.querySelector('.js-check-change')).onchange = document.querySelector('.js-check-change').checked;

                //}
                //if (Type == "True") {
                //    debugger;
                //    document.querySelector('.js-check-change').checked = true;
                //    (document.querySelector('.js-check-change')).onchange = document.querySelector('.js-check-change').checked;

                //}
                var Type1 = "@Model.Type";
                var remise = "@Model.REMISE";
                var designation = decodeHtml("@Model.Designation");
                $("#designation").val(designation);

                $("#remise").val(parseFloat(remise.replace(",", ".")));
                var codeFournisseur = "@ViewBag.CODE_FOURNISSEUR";
                var codeFournisseur = "@ViewBag.CODE_FOURNISSEUR";
                var date = "@Model.DATE";
                date = date.replace(" 00:00:00", "");
                var modePaiement = "@Model.MODE_PAIEMENT";
                modePaiement = modePaiement.replace("&#232;", "è");
                modePaiement = modePaiement.replace("&#233;", "é");
                $("#date").val(date);
                //
                @*var totalHT = "@Model.THT";
                var NetHT = "@Model.NHT";
                var totalTVA = "@Model.TTVA";
                var TotalTTC = "@Model.TTC";
                var netAPaye = "@Model.TNET";*@

            var totalHT = ("@Model.THT").replace(",", ".");
            var NetHT = ("@Model.NHT").replace(",", ".");
            var totalTVA = ("@Model.TTVA").replace(",", ".");
            var TotalTTC = ("@Model.TTC").replace(",", ".");
            var netAPaye = ("@Model.TNET").replace(",", ".");

                totalHT = parseFloat(totalHT);
                NetHT = parseFloat(NetHT);
                totalTVA = parseFloat(totalTVA);
                TotalTTC = parseFloat(TotalTTC);
                netAPaye = parseFloat(netAPaye);

                $("#type").val(Type1);
                $("#totalHT").val(totalHT.toFixed(3));
                $("#NetHT").val(NetHT.toFixed(3));
                $("#totalTVA").val(totalTVA.toFixed(3));
                $("#TotalTTC").val(TotalTTC.toFixed(3));
                $("#netAPaye").val(netAPaye.toFixed(3));
                $("#client").val(client).trigger("change");
                $("#codeClient").val(codeClient);
                $("#modePaiement option").each(function (i, item) {
                    if ($(this).attr("value") == modePaiement) {
                        $(this).attr("selected", true);
                    }
                });

                RemplirTableau1();

            }
            
            //******************************************************************
            $(document).on("keydown", "input[type=number][data-modif!=edited]", function (e) {
                if (document.querySelector('.js-check-change').checked == false) {

                    var Qte = $("#QuantiteProduit").val();
                    var Qteliv = $("#QuantiteLiv").val();
                    Qte = parseInt(Qte)
                    Qteliv = parseInt(Qteliv);
                    var QteRes = Qte - Qteliv;
                    $('#QuantiteRes').val(QteRes);
                    var PRIX_VENTE_HT = parseFloat($('#PUHTProduit').val());
                    var PrixTotHTSansRemise = Qte * PRIX_VENTE_HT;
                    var Remise = $("#RemiseProduit").val();
                    Remise = parseFloat(Remise);
                    var MontantRemise = (PrixTotHTSansRemise * Remise) / 100;
                    var PTHTProduit = PrixTotHTSansRemise - MontantRemise;
                    $('#PTHTProduit').val(PTHTProduit.toFixed(3));
                    var TVA = $('#TVAProduit').val();
                    TVA = parseFloat(TVA);
                    var MontantTVA = (PTHTProduit * TVA) / 100;
                    var TTCProduit = PTHTProduit + MontantTVA;
                    $('#TTCProduit').val(TTCProduit.toFixed(3));

                }
                if (document.querySelector('.js-check-change').checked) {

                    var Qte = $("#QuantiteProduit").val();


                    Qte = parseInt(Qte);
                    $('#QuantiteLiv').val(Qte);

                    var QteRes = 0;
                    $('#QuantiteRes').val(QteRes);

                    var PRIX_VENTE_HT = parseFloat($('#PUHTProduit').val());
                    var PrixTotHTSansRemise = Qte * PRIX_VENTE_HT;
                    var Remise = $("#RemiseProduit").val();
                    Remise = parseFloat(Remise);
                    var MontantRemise = (PrixTotHTSansRemise * Remise) / 100;
                    var PTHTProduit = PrixTotHTSansRemise - MontantRemise;
                    $('#PTHTProduit').val(PTHTProduit.toFixed(3));
                    var TVA = $('#TVAProduit').val();
                    TVA = parseFloat(TVA);
                    var MontantTVA = (PTHTProduit * TVA) / 100;
                    var TTCProduit = PTHTProduit + MontantTVA;
                    $('#TTCProduit').val(TTCProduit.toFixed(3));

                }
                var Qte1 = $("#QuantiteSERVICE").val();
                Qte1 = parseFloat(Qte1);
                var PRIX_VENTE_HT1 = parseFloat($('#PUHTSERVICE').val());
                var PrixTotHTSansRemise1 = Qte1 * PRIX_VENTE_HT1;
                var Remise1 = $("#RemiseSERVICE").val();
                Remise1 = parseFloat(Remise1);
                var MontantRemise1 = (PrixTotHTSansRemise1 * Remise1) / 100;
                var PTHTProduit1 = PrixTotHTSansRemise1 - MontantRemise1;
                $('#PTHTSERVICE').val(PTHTProduit1.toFixed(3));
                var TVA1 = $('#TVASERVICE').val();
                TVA1 = parseFloat(TVA1);

                var MontantTVA1 = (PTHTProduit1 * TVA1) / 100;

                var TTCProduit1 = PTHTProduit1 + MontantTVA1;

                $('#TTCSERVICE').val(TTCProduit1.toFixed(3));
            });
            $(document).on("keyup", "input[type=number][data-modif!=edited]", function (e) {
                if (document.querySelector('.js-check-change').checked == false) {
                  
                    var Qte = $("#QuantiteProduit").val();
                    var Qteliv = $("#QuantiteLiv").val();
                    
                   
                    Qte = parseInt(Qte)
                    Qteliv = parseInt(Qteliv);
                    var QteRes = Qte - Qteliv;
                    $('#QuantiteRes').val(QteRes);

                    var PRIX_VENTE_HT = parseFloat($('#PUHTProduit').val());
                    var PrixTotHTSansRemise = Qte * PRIX_VENTE_HT;
                    var Remise = $("#RemiseProduit").val();
                    Remise = parseFloat(Remise);
                    var MontantRemise = (PrixTotHTSansRemise * Remise) / 100;
                    var PTHTProduit = PrixTotHTSansRemise - MontantRemise;
                    $('#PTHTProduit').val(PTHTProduit.toFixed(3));
                    var TVA = $('#TVAProduit').val();
                    TVA = parseFloat(TVA);
                    var MontantTVA = (PTHTProduit * TVA) / 100;
                    var TTCProduit = PTHTProduit + MontantTVA;
                    $('#TTCProduit').val(TTCProduit.toFixed(3));

                }
                if (document.querySelector('.js-check-change').checked) {

                    var Qte = $("#QuantiteProduit").val();


                    Qte = parseInt(Qte);
                    $('#QuantiteLiv').val(Qte);

                    var QteRes = 0;
                    $('#QuantiteRes').val(QteRes);

                    var PRIX_VENTE_HT = parseFloat($('#PUHTProduit').val());
                    var PrixTotHTSansRemise = Qte * PRIX_VENTE_HT;
                    var Remise = $("#RemiseProduit").val();
                    Remise = parseFloat(Remise);
                    var MontantRemise = (PrixTotHTSansRemise * Remise) / 100;
                    var PTHTProduit = PrixTotHTSansRemise - MontantRemise;
                    $('#PTHTProduit').val(PTHTProduit.toFixed(3));
                    var TVA = $('#TVAProduit').val();
                    TVA = parseFloat(TVA);
                    var MontantTVA = (PTHTProduit * TVA) / 100;
                    var TTCProduit = PTHTProduit + MontantTVA;
                    $('#TTCProduit').val(TTCProduit.toFixed(3));

                }
                var Qte1 = $("#QuantiteSERVICE").val();
                Qte1 = parseFloat(Qte1);
                var PRIX_VENTE_HT1 = parseFloat($('#PUHTSERVICE').val());
                var PrixTotHTSansRemise1 = Qte1 * PRIX_VENTE_HT1;
                var Remise1 = $("#RemiseSERVICE").val();
                Remise1 = parseFloat(Remise1);
                var MontantRemise1 = (PrixTotHTSansRemise1 * Remise1) / 100;
                var PTHTProduit1 = PrixTotHTSansRemise1 - MontantRemise1;
                $('#PTHTSERVICE').val(PTHTProduit1.toFixed(3));
                var TVA1 = $('#TVASERVICE').val();
                TVA1 = parseFloat(TVA1);

                var MontantTVA1 = (PTHTProduit1 * TVA1) / 100;

                var TTCProduit1 = PTHTProduit1 + MontantTVA1;

                $('#TTCSERVICE').val(TTCProduit1.toFixed(3));
            });

            //******************************************************************

           
            //******************************************************************
           
        });
        $(document).on("keydown", "input[data-modif=edited]", function (e) {
            var Mode = "@ViewBag.Mode";
            if (document.querySelector('.js-check-change').checked == true) {
                debugger;
                var Qte = $("#NEW_QTE").val();
                Qte = parseInt(Qte);

                var QteLiv = $("#NEW_QTELIV").val();
                var QteRes = Qte - QteLiv;
                $("#NEW_QTELIV").text(Qte);

                $('#NEW_QTERES').text(QteRes);
                var PRIX_VENTE_HT = parseFloat($('#NEW_PUHT').val());
                var PrixTotHTSansRemise = Qte * PRIX_VENTE_HT;
                var Remise = $("#NEW_REMISE").val();
                Remise = parseFloat(Remise);
                var MontantRemise = (PrixTotHTSansRemise * Remise) / 100;
                var PTHTProduit = PrixTotHTSansRemise - MontantRemise;
                $('#NEW_PTHT').text(PTHTProduit.toFixed(3));
                var TVA = $('#NEW_TVA').val();
                TVA = parseFloat(TVA);
                var MontantTVA = (PTHTProduit * TVA) / 100;
                var TTCProduit = PTHTProduit + MontantTVA;
                $('#NEW_PTCT').text(TTCProduit.toFixed(3));
            }
            if (document.querySelector('.js-check-change').checked == false) {
                if ((Mode == "Edit") || (Mode == "Editcmd")||(Mode == "Create")) {
                    var Qte = $("#NEW_QTE").text();
                    Qte = parseInt(Qte);
                    var QteLiv = $("#NEW_QTELIV").val();
                    QteLiv = parseInt(QteLiv);
                    var QteRes = Qte - QteLiv;
                    $('#NEW_QTERES').text(QteRes);
                    var PRIX_VENTE_HT = parseFloat($('#NEW_PUHT').text());
                    var PrixTotHTSansRemise = QteLiv * PRIX_VENTE_HT;
                    var Remise = $("#NEW_REMISE").text();
                    Remise = parseFloat(Remise);
                    var MontantRemise = (PrixTotHTSansRemise * Remise) / 100;
                    var PTHTProduit = PrixTotHTSansRemise - MontantRemise;
                    $('#NEW_PTHT').text(PTHTProduit.toFixed(3));
                    var TVA = $('#NEW_TVA').text();
                    TVA = parseFloat(TVA);
                    var MontantTVA = (PTHTProduit * TVA) / 100;
                    var TTCProduit = PTHTProduit + MontantTVA;
                    $('#NEW_PTCT').text(TTCProduit.toFixed(3));
                }
                //if (Mode == "Create") {
                //    var Qte = $("#NEW_QTE").text();
                //    Qte = parseInt(Qte);
                //    var QteLiv = $("#NEW_QTELIV").val();
                //    QteLiv = parseInt(QteLiv);
                //    var QteRes = Qte - QteLiv;
                //    $('#NEW_QTERES').text(QteRes);
                //    var PRIX_VENTE_HT = parseFloat($('#NEW_PUHT').text());
                //    var PrixTotHTSansRemise = QteLiv * PRIX_VENTE_HT;
                //    var Remise = $("#NEW_REMISE").text();
                //    Remise = parseFloat(Remise);
                //    var MontantRemise = (PrixTotHTSansRemise * Remise) / 100;
                //    var PTHTProduit = PrixTotHTSansRemise - MontantRemise;
                //    $('#NEW_PTHT').text(PTHTProduit.toFixed(3));
                //    var TVA = $('#NEW_TVA').text();
                //    TVA = parseFloat(TVA);
                //    var MontantTVA = (PTHTProduit * TVA) / 100;
                //    var TTCProduit = PTHTProduit + MontantTVA;
                //    $('#NEW_PTCT').text(TTCProduit.toFixed(3));
                //}
            }
        });
        $(document).on("keyup", "input[data-modif=edited]", function (e) {
            debugger;
            var Mode = "@ViewBag.Mode";
            if (document.querySelector('.js-check-change').checked == true) {
                var Qte = $("#NEW_QTE").val();
                Qte = parseInt(Qte);
                var QteLiv = $("#NEW_QTELIV").val();
                QteLiv = parseInt(QteLiv);
                var QteRes = Qte - QteLiv;
                $("#NEW_QTELIV").text(Qte);
                $('#NEW_QTERES').text(QteRes);
                var PRIX_VENTE_HT = parseFloat($('#NEW_PUHT').val());
                var PrixTotHTSansRemise = QteLiv * PRIX_VENTE_HT;
                var Remise = $("#NEW_REMISE").val();
                Remise = parseFloat(Remise);
                var MontantRemise = (PrixTotHTSansRemise * Remise) / 100;
                var PTHTProduit = PrixTotHTSansRemise - MontantRemise;
                $('#NEW_PTHT').text(PTHTProduit.toFixed(3));
                var TVA = $('#NEW_TVA').val();
                TVA = parseFloat(TVA);
                var MontantTVA = (PTHTProduit * TVA) / 100;
                var TTCProduit = PTHTProduit + MontantTVA;
                $('#NEW_PTCT').text(TTCProduit.toFixed(3));
            }
            if (document.querySelector('.js-check-change').checked == false) {
                if ((Mode == "Edit") || (Mode == "Editcmd") || (Mode == "Create")) {
                    var Qte = $("#NEW_QTE").text();
                    if (Qte == "")
                    {
                        var Qte = $("#NEW_QTE").val();
                        Qte = parseInt(Qte);
                        $("#NEW_QTELIV").text(0);
                        $('#NEW_QTERES').text(0);
                        var PRIX_VENTE_HT = parseFloat($('#NEW_PUHT').val());
                        var PrixTotHTSansRemise = Qte * PRIX_VENTE_HT;
                        var Remise = $("#NEW_REMISE").val();
                        Remise = parseFloat(Remise);
                        var MontantRemise = (PrixTotHTSansRemise * Remise) / 100;
                        var PTHTProduit = PrixTotHTSansRemise - MontantRemise;
                        $('#NEW_PTHT').text(PTHTProduit.toFixed(3));
                        var TVA = $('#NEW_TVA').val();
                        TVA = parseFloat(TVA);
                        var MontantTVA = (PTHTProduit * TVA) / 100;
                        var TTCProduit = PTHTProduit + MontantTVA;
                        $('#NEW_PTCT').text(TTCProduit.toFixed(3));
                    }
                    else
                    {
                    Qte = parseInt(Qte);
                    var QteLiv = $("#NEW_QTELIV").val();
                    QteLiv = parseFloat(QteLiv);
                    var QteRes = Qte - QteLiv;
                    $('#NEW_QTERES').text(QteRes);
                    var PRIX_VENTE_HT = parseFloat($('#NEW_PUHT').text());
                    var PrixTotHTSansRemise = QteLiv * PRIX_VENTE_HT;
                    var Remise = $("#NEW_REMISE").text();
                    Remise = parseFloat(Remise);
                    var MontantRemise = (PrixTotHTSansRemise * Remise) / 100;
                    var PTHTProduit = PrixTotHTSansRemise - MontantRemise;
                    $('#NEW_PTHT').text(PTHTProduit.toFixed(3));
                    var TVA = $('#NEW_TVA').text();
                    TVA = parseFloat(TVA);
                    var MontantTVA = (PTHTProduit * TVA) / 100;
                    var TTCProduit = PTHTProduit + MontantTVA;
                    $('#NEW_PTCT').text(TTCProduit.toFixed(3));
                    }
                }
                //if (Mode == "Create") {

                //    var Qte = $("#NEW_QTE").text();
                //    Qte = parseInt(Qte);
                //    var QteLiv = $("#NEW_QTELIV").val();
                //    QteLiv = parseInt(QteLiv);
                //    var QteRes = Qte - QteLiv;
                //    $('#NEW_QTERES').text(QteRes);
                //    var PRIX_VENTE_HT = parseFloat($('#NEW_PUHT').text());
                //    var PrixTotHTSansRemise = QteLiv * PRIX_VENTE_HT;
                //    var Remise = $("#NEW_REMISE").text();
                //    Remise = parseFloat(Remise);
                //    var MontantRemise = (PrixTotHTSansRemise * Remise) / 100;
                //    var PTHTProduit = PrixTotHTSansRemise - MontantRemise;
                //    $('#NEW_PTHT').text(PTHTProduit.toFixed(3));
                //    var TVA = $('#NEW_TVA').text();
                //    TVA = parseFloat(TVA);
                //    var MontantTVA = (PTHTProduit * TVA) / 100;
                //    var TTCProduit = PTHTProduit + MontantTVA;
                //    $('#NEW_PTCT').text(TTCProduit.toFixed(3));
                //}

            }
        });
        $(document).on("click", "#Tableau tbody tr td", function (e) {
            var Mode = "@ViewBag.Mode";
            if (document.querySelector('.js-check-change').checked == false) {
                if (Mode == "Edit" || Mode == "Editcmd" || Mode == "Create" ) {
                    var index = this.cellIndex;
                    var html = this.innerText;
                    var Parent = this.parentNode.id;
                    var locked = $("#" + Parent).attr("data-locked");

                    var CELL_QTE = $("#Tableau tbody tr[id=" + Parent + "] td")[8];
                    var CELL_QTELIV = $("#Tableau tbody tr[id=" + Parent + "] td")[9];
                    var CELL_QTERES = $("#Tableau tbody tr[id=" + Parent + "] td")[10];
                    var CELL_PUHT = $("#Tableau tbody tr[id=" + Parent + "] td")[11];
                    var CELL_REMISE = $("#Tableau tbody tr[id=" + Parent + "] td")[12];
                    var CELL_PTHT = $("#Tableau tbody tr[id=" + Parent + "] td")[13];

                    var CELL_TVA = $("#Tableau tbody tr[id=" + Parent + "] td")[14];
                    var CELL_PTTC = $("#Tableau tbody tr[id=" + Parent + "] td")[15];


                    var TXT_QTE = $(CELL_QTE).html();
                    var TXT_QTELIV = $(CELL_QTELIV).html();
                    var TXT_QTERES = $(CELL_QTERES).html();
                    var TXT_PUHT = $(CELL_PUHT).html();
                    var TXT_REMISE = $(CELL_REMISE).html();
                    var TXT_PTHT = $(CELL_PTHT).html();
                    var TXT_TVA = $(CELL_TVA).html();
                    var TXT_PTCT = $(CELL_PTTC).html();



                    if (index == 8 && $(this).html().indexOf("number") < 0 && locked != "true") {
                        $(this).html("");
                        $(this).append("<input type='number' class='form-control' id='NEW_QTE' value='" + html + "' data-modif='edited'>");
                        //-----------------------------------------------------------------
                        $(CELL_PTHT).html("");
                        $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                        $(CELL_PTTC).html("");
                        $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                        $(CELL_QTERES).html("");
                        $(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                        $(CELL_QTELIV).html("");
                        $(CELL_QTELIV).append("<strong id='NEW_QTELIV'>" + TXT_QTELIV + "</strong>");
                        //-----------------------------------------------------------------


                        $(CELL_PUHT).html("");
                        $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");

                        //$(CELL_QTELIV).html("");
                        //$(CELL_QTELIV).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + TXT_QTELIV + "' data-modif='edited'>");

                        $(CELL_REMISE).html("");
                        $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");

                        $(CELL_TVA).html("");
                        $(CELL_TVA).append("<input type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'>");
                        //-----------------------------------------------------------------

                        $("#BtnRow_" + Parent).attr("disabled", false);
                        LockRow(Parent);
                    }
                    if (index == 9 && $(this).html().indexOf("number") < 0 && locked != "true") {
                        $(this).html("");
                        $(this).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + html + "' data-modif='edited'>");

                        //-----------------------------------------------------------------
                        $(CELL_PTHT).html("");
                        $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                        $(CELL_PTTC).html("");
                        $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                        $(CELL_QTERES).html("");
                        $(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                        $(CELL_QTE).html("");
                        $(CELL_QTE).append("<strong id='NEW_QTE'>" + TXT_QTE + "</strong>");
                        $(CELL_PUHT).html("");
                        $(CELL_PUHT).append("<strong id='NEW_PUHT'>" + TXT_PUHT + "</strong>");
                        $(CELL_TVA).html("");
                        $(CELL_TVA).append("<strong id='NEW_TVA'>" + TXT_TVA + "</strong>");
                        $(CELL_REMISE).html("");
                        $(CELL_REMISE).append("<strong id='NEW_REMISE'>" + TXT_REMISE + "</strong>");
                        //-----------------------------------------------------------------


                        //    $(CELL_PUHT).html("");
                        //    $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");

                            //$(CELL_QTE).html("");
                            //$(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");

                        //    $(CELL_REMISE).html("");
                        //    $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");

                        //    $(CELL_TVA).html("");
                        //    $(CELL_TVA).append("<input type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'>");
                        //    //-----------------------------------------------------------------

                        //    $("#BtnRow_" + Parent).attr("disabled", false);
                        //    LockRow(Parent);
                        //}
                        //if (index == 11 && $(this).html().indexOf("number") < 0 && locked != "true") {
                        //    $(this).html("");
                        //    $(this).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + html + "' data-modif='edited'>");
                        //    $(CELL_PTHT).html("");
                        //    $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                        //    $(CELL_PTTC).html("");
                        //    $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                        //    //$(CELL_QTERES).html("");
                        //    //$(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                        //    //-----------------------------------------------------------------
                        //    $(CELL_QTE).html("");
                        //    $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");

                        //    $(CELL_QTELIV).html("");
                        //    $(CELL_QTELIV).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + TXT_QTELIV + "' data-modif='edited'>");

                        //    $(CELL_REMISE).html("");
                        //    $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");

                        //    $(CELL_TVA).html("");
                        //    $(CELL_TVA).append("<input type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'>");
                        //    //-----------------------------------------------------------------
                        //    $("#BtnRow_" + Parent).attr("disabled", false);
                        //    LockRow(Parent);
                        //}
                        //if (index == 12 && $(this).html().indexOf("number") < 0 && locked != "true") {
                        //    $(this).html("");
                        //    $(this).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + html + "' data-modif='edited'>");
                        //    $(CELL_PTHT).html("");
                        //    $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                        //    $(CELL_PTTC).html("");
                        //    $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                        //    //$(CELL_QTERES).html("");
                        //    //$(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                        //    //-----------------------------------------------------------------
                        //    $(CELL_QTE).html("");
                        //    $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");

                        //    $(CELL_QTELIV).html("");
                        //    $(CELL_QTELIV).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + TXT_QTELIV + "' data-modif='edited'>");

                        //    $(CELL_PUHT).html("");
                        //    $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");

                        //    $(CELL_TVA).html("");
                        //    $(CELL_TVA).append("<input type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'>");
                        //    //-----------------------------------------------------------------
                        //    $("#BtnRow_" + Parent).attr("disabled", false);
                        //    LockRow(Parent);
                        //}
                        //if (index == 14 && $(this).html().indexOf("number") < 0 && locked != "true") {
                        //    $(this).html("");
                        //    $(this).append("<input type='number' class='form-control' id='NEW_TVA' value='" + html + "' data-modif='edited'>");
                        //    $(CELL_PTHT).html("");
                        //    $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                        //    $(CELL_PTTC).html("");
                        //    $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                        //    //$(CELL_QTERES).html("");
                        //    //$(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                        //    //-----------------------------------------------------------------
                        //    $(CELL_QTE).html("");
                        //    $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");

                        //    $(CELL_QTELIV).html("");
                        //    $(CELL_QTELIV).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + TXT_QTELIV + "' data-modif='edited'>");

                        //    $(CELL_PUHT).html("");
                        //    $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");

                        //    $(CELL_REMISE).html("");
                        //    $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");
                        //    //-----------------------------------------------------------------
                        $("#BtnRow_" + Parent).attr("disabled", false);
                        LockRow(Parent);

                    }
                    if (index == 11 && $(this).html().indexOf("number") < 0 && locked != "true") {
                            $(this).html("");
                            $(this).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + html + "' data-modif='edited'>");
                            $(CELL_PTHT).html("");
                            $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                            $(CELL_PTTC).html("");
                            $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                            $(CELL_QTERES).html("");
                            $(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                            $(CELL_QTELIV).html("");
                            $(CELL_QTELIV).append("<strong id='NEW_QTELIV'>" + TXT_QTELIV + "</strong>");
                            //-----------------------------------------------------------------
                            $(CELL_QTE).html("");
                            $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");

                            //$(CELL_QTELIV).html("");
                            //$(CELL_QTELIV).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + TXT_QTELIV + "' data-modif='edited'>");

                            $(CELL_REMISE).html("");
                            $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");

                            $(CELL_TVA).html("");
                            $(CELL_TVA).append("<input type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'>");
                            //-----------------------------------------------------------------
                            $("#BtnRow_" + Parent).attr("disabled", false);
                            LockRow(Parent);
                    }
                    if (index == 12 && $(this).html().indexOf("number") < 0 && locked != "true") {
                        $(this).html("");
                        $(this).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + html + "' data-modif='edited'>");
                        $(CELL_PTHT).html("");
                        $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                        $(CELL_PTTC).html("");
                        $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                        $(CELL_QTERES).html("");
                        $(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                        $(CELL_QTELIV).html("");
                        $(CELL_QTELIV).append("<strong id='NEW_QTERES'>" + TXT_QTELIV + "</strong>");
                        //-----------------------------------------------------------------
                        $(CELL_QTE).html("");
                        $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");

                        //$(CELL_QTELIV).html("");
                        //$(CELL_QTELIV).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + TXT_QTELIV + "' data-modif='edited'>");

                        $(CELL_PUHT).html("");
                        $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");

                        $(CELL_TVA).html("");
                        $(CELL_TVA).append("<input type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'>");
                        //-----------------------------------------------------------------
                        $("#BtnRow_" + Parent).attr("disabled", false);
                        LockRow(Parent);
                    }
                }
                //if (Mode == "Editcmd") {

                //    var index = this.cellIndex;
                //    var html = this.innerText;
                //    var Parent = this.parentNode.id;
                //    var locked = $("#" + Parent).attr("data-locked");

                //    //var CELL_QTE = $("#Tableau tbody tr[id=" + Parent + "] td")[8];
                //    var CELL_QTELIV = $("#Tableau tbody tr[id=" + Parent + "] td")[9];
                //    //var CELL_QTERES = $("#Tableau tbody tr[id=" + Parent + "] td")[10];
                //    //var CELL_PUHT = $("#Tableau tbody tr[id=" + Parent + "] td")[11];
                //    //var CELL_REMISE = $("#Tableau tbody tr[id=" + Parent + "] td")[12];
                //    //var CELL_PTHT = $("#Tableau tbody tr[id=" + Parent + "] td")[13];

                //    //var CELL_TVA = $("#Tableau tbody tr[id=" + Parent + "] td")[14];
                //    //var CELL_PTTC = $("#Tableau tbody tr[id=" + Parent + "] td")[15];


                //    //var TXT_QTE = $(CELL_QTE).html();
                //    var TXT_QTELIV = $(CELL_QTELIV).html();
                //    //var TXT_QTERES = $(CELL_QTERES).html();
                //    //var TXT_PUHT = $(CELL_PUHT).html();
                //    //var TXT_REMISE = $(CELL_REMISE).html();
                //    //var TXT_PTHT = $(CELL_PTHT).html();
                //    //var TXT_TVA = $(CELL_TVA).html();
                //    //var TXT_PTCT = $(CELL_PTTC).html();



                //    //if (index == 8 && $(this).html().indexOf("number") < 0 && locked != "true") {
                //    //    QTERES = parseInt(TXT_QTERES);
                //    //    $(this).html("");
                //    //    $(this).append("<input type='number' class='form-control' id='NEW_QTE' value='" + html + "' data-modif='edited'>");
                //    //    //-----------------------------------------------------------------
                //    //    $(CELL_PTHT).html("");
                //    //    $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                //    //    $(CELL_PTTC).html("");
                //    //    $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                //    //    //$(CELL_QTERES).html("");
                //    //    //$(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                //    //    //-----------------------------------------------------------------


                //    //    $(CELL_PUHT).html("");
                //    //    $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");

                //    //    $(CELL_QTELIV).html("");
                //    //    $(CELL_QTELIV).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + TXT_QTELIV + "' data-modif='edited'>");

                //    //    $(CELL_REMISE).html("");
                //    //    $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");

                //    //    $(CELL_TVA).html("");
                //    //    $(CELL_TVA).append("<input type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'>");
                //    //    //-----------------------------------------------------------------

                //    //    $("#BtnRow_" + Parent).attr("disabled", false);
                //    //    LockRow(Parent);
                //    //}
                //    if (index == 9 && $(this).html().indexOf("number") < 0 && locked != "true") {
                //        $(this).html("");
                //        $(this).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + html + "' data-modif='edited'>");

                //        //-----------------------------------------------------------------
                //        //$(CELL_PTHT).html("");
                //        //$(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                //        //$(CELL_PTTC).html("");
                //        //$(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                //        //$(CELL_QTERES).html("");
                //        //$(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                //        //-----------------------------------------------------------------


                //        //    $(CELL_PUHT).html("");
                //        //    $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");

                //        //    $(CELL_QTE).html("");
                //        //    $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");

                //        //    $(CELL_REMISE).html("");
                //        //    $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");

                //        //    $(CELL_TVA).html("");
                //        //    $(CELL_TVA).append("<input type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'>");
                //        //    //-----------------------------------------------------------------

                //        //    $("#BtnRow_" + Parent).attr("disabled", false);
                //        //    LockRow(Parent);
                //        //}
                //        //if (index == 11 && $(this).html().indexOf("number") < 0 && locked != "true") {
                //        //    $(this).html("");
                //        //    $(this).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + html + "' data-modif='edited'>");
                //        //    $(CELL_PTHT).html("");
                //        //    $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                //        //    $(CELL_PTTC).html("");
                //        //    $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                //        //    //$(CELL_QTERES).html("");
                //        //    //$(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                //        //    //-----------------------------------------------------------------
                //        //    $(CELL_QTE).html("");
                //        //    $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");

                //        //    $(CELL_QTELIV).html("");
                //        //    $(CELL_QTELIV).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + TXT_QTELIV + "' data-modif='edited'>");

                //        //    $(CELL_REMISE).html("");
                //        //    $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");

                //        //    $(CELL_TVA).html("");
                //        //    $(CELL_TVA).append("<input type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'>");
                //        //    //-----------------------------------------------------------------
                //        //    $("#BtnRow_" + Parent).attr("disabled", false);
                //        //    LockRow(Parent);
                //        //}
                //        //if (index == 12 && $(this).html().indexOf("number") < 0 && locked != "true") {
                //        //    $(this).html("");
                //        //    $(this).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + html + "' data-modif='edited'>");
                //        //    $(CELL_PTHT).html("");
                //        //    $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                //        //    $(CELL_PTTC).html("");
                //        //    $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                //        //    //$(CELL_QTERES).html("");
                //        //    //$(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                //        //    //-----------------------------------------------------------------
                //        //    $(CELL_QTE).html("");
                //        //    $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");

                //        //    $(CELL_QTELIV).html("");
                //        //    $(CELL_QTELIV).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + TXT_QTELIV + "' data-modif='edited'>");

                //        //    $(CELL_PUHT).html("");
                //        //    $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");

                //        //    $(CELL_TVA).html("");
                //        //    $(CELL_TVA).append("<input type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'>");
                //        //    //-----------------------------------------------------------------
                //        //    $("#BtnRow_" + Parent).attr("disabled", false);
                //        //    LockRow(Parent);
                //        //}
                //        //if (index == 14 && $(this).html().indexOf("number") < 0 && locked != "true") {
                //        //    $(this).html("");
                //        //    $(this).append("<input type='number' class='form-control' id='NEW_TVA' value='" + html + "' data-modif='edited'>");
                //        //    $(CELL_PTHT).html("");
                //        //    $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                //        //    $(CELL_PTTC).html("");
                //        //    $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                //        //    //$(CELL_QTERES).html("");
                //        //    //$(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                //        //    //-----------------------------------------------------------------
                //        //    $(CELL_QTE).html("");
                //        //    $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");

                //        //    $(CELL_QTELIV).html("");
                //        //    $(CELL_QTELIV).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + TXT_QTELIV + "' data-modif='edited'>");

                //        //    $(CELL_PUHT).html("");
                //        //    $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");

                //        //    $(CELL_REMISE).html("");
                //        //    $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");
                //        //    //-----------------------------------------------------------------
                //        $("#BtnRow_" + Parent).attr("disabled", false);
                //        LockRow(Parent);

                //    }
                //}
                //if (Mode == "Create") {

                //    var index = this.cellIndex;
                //    var html = this.innerText;
                //    var Parent = this.parentNode.id;
                //    var locked = $("#" + Parent).attr("data-locked");

                //    var CELL_QTE = $("#Tableau tbody tr[id=" + Parent + "] td")[8];
                //    var CELL_QTELIV = $("#Tableau tbody tr[id=" + Parent + "] td")[9];
                //    var CELL_QTERES = $("#Tableau tbody tr[id=" + Parent + "] td")[10];
                //    var CELL_PUHT = $("#Tableau tbody tr[id=" + Parent + "] td")[11];
                //    var CELL_REMISE = $("#Tableau tbody tr[id=" + Parent + "] td")[12];
                //    var CELL_PTHT = $("#Tableau tbody tr[id=" + Parent + "] td")[13];

                //    var CELL_TVA = $("#Tableau tbody tr[id=" + Parent + "] td")[14];
                //    var CELL_PTTC = $("#Tableau tbody tr[id=" + Parent + "] td")[15];


                //    var TXT_QTE = $(CELL_QTE).html();
                //    var TXT_QTELIV = $(CELL_QTELIV).html();
                //    var TXT_QTERES = $(CELL_QTERES).html();
                //    var TXT_PUHT = $(CELL_PUHT).html();
                //    var TXT_REMISE = $(CELL_REMISE).html();
                //    var TXT_PTHT = $(CELL_PTHT).html();
                //    var TXT_TVA = $(CELL_TVA).html();
                //    var TXT_PTCT = $(CELL_PTTC).html();



                //    if (index == 8 && $(this).html().indexOf("number") < 0 && locked != "true") {
                //        QTERES = parseInt(TXT_QTERES);
                //        $(this).html("");
                //        $(this).append("<input type='number' class='form-control' id='NEW_QTE' value='" + html + "' data-modif='edited'>");
                //        //-----------------------------------------------------------------
                //        $(CELL_PTHT).html("");
                //        $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                //        $(CELL_PTTC).html("");
                //        $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                //        $(CELL_QTERES).html("");
                //        $(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                //        //-----------------------------------------------------------------


                //        $(CELL_PUHT).html("");
                //        $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");

                //        $(CELL_QTELIV).html("");
                //        $(CELL_QTELIV).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + TXT_QTELIV + "' data-modif='edited'>");

                //        $(CELL_REMISE).html("");
                //        $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");


                //        $(CELL_TVA).html("");
                //        $(CELL_TVA).append("<select type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'></select>");
                //        //-----------------------------------------------------------------

                //        $("#BtnRow_" + Parent).attr("disabled", false);
                //        LockRow(Parent);
                //        RemplirListeNewTva();

                //    }
                //    if (index == 9 && $(this).html().indexOf("number") < 0 && locked != "true") {
                //        $(this).html("");
                //        $(this).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + html + "' data-modif='edited'>");
                //        //-----------------------------------------------------------------
                //        $(CELL_PTHT).html("");
                //        $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                //        $(CELL_PTTC).html("");
                //        $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                //        $(CELL_QTERES).html("");
                //        $(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                //        //-----------------------------------------------------------------


                //        $(CELL_PUHT).html("");
                //        $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");

                //        $(CELL_QTE).html("");
                //        $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");

                //        $(CELL_REMISE).html("");
                //        $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");

                //        $(CELL_TVA).html("");
                //        $(CELL_TVA).append("<select type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'></select>");
                //        //-----------------------------------------------------------------

                //        $("#BtnRow_" + Parent).attr("disabled", false);
                //        LockRow(Parent);
                //        RemplirListeNewTva();

                //    }
                //    if (index == 11 && $(this).html().indexOf("number") < 0 && locked != "true") {
                //        $(this).html("");
                //        $(this).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + html + "' data-modif='edited'>");
                //        $(CELL_PTHT).html("");
                //        $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                //        $(CELL_PTTC).html("");
                //        $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                //        $(CELL_QTERES).html("");
                //        $(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                //        //-----------------------------------------------------------------
                //        $(CELL_QTE).html("");
                //        $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");

                //        $(CELL_QTELIV).html("");
                //        $(CELL_QTELIV).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + TXT_QTELIV + "' data-modif='edited'>");

                //        $(CELL_REMISE).html("");
                //        $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");

                //        $(CELL_TVA).html("");
                //        $(CELL_TVA).append("<select type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'></select>");
                //        //-----------------------------------------------------------------
                //        $("#BtnRow_" + Parent).attr("disabled", false);
                //        LockRow(Parent);
                //        RemplirListeNewTva();

                //    }
                //    if (index == 12 && $(this).html().indexOf("number") < 0 && locked != "true") {
                //        $(this).html("");
                //        $(this).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + html + "' data-modif='edited'>");
                //        $(CELL_PTHT).html("");
                //        $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                //        $(CELL_PTTC).html("");
                //        $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                //        $(CELL_QTERES).html("");
                //        $(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                //        //-----------------------------------------------------------------
                //        $(CELL_QTE).html("");
                //        $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");

                //        $(CELL_QTELIV).html("");
                //        $(CELL_QTELIV).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + TXT_QTELIV + "' data-modif='edited'>");

                //        $(CELL_PUHT).html("");
                //        $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");

                //        $(CELL_TVA).html("");
                //        $(CELL_TVA).append("<select type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'></select>");
                //        //-----------------------------------------------------------------
                //        $("#BtnRow_" + Parent).attr("disabled", false);
                //        LockRow(Parent);
                //        RemplirListeNewTva();

                //    }
                //    if (index == 14 && $(this).html().indexOf("number") < 0 && locked != "true") {
                //        $(this).html("");
                //        $(this).append("<select type='number' class='form-control' id='NEW_TVA' value='" + html + "' data-modif='edited'></select>");
                //        $(CELL_PTHT).html("");
                //        $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                //        $(CELL_PTTC).html("");
                //        $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                //        $(CELL_QTERES).html("");
                //        $(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                //        //-----------------------------------------------------------------
                //        $(CELL_QTE).html("");
                //        $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");

                //        $(CELL_QTELIV).html("");
                //        $(CELL_QTELIV).append("<input type='number' class='form-control' id='NEW_QTELIV' value='" + TXT_QTELIV + "' data-modif='edited'>");

                //        $(CELL_PUHT).html("");
                //        $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");

                //        $(CELL_REMISE).html("");
                //        $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");
                //        //-----------------------------------------------------------------
                //        $("#BtnRow_" + Parent).attr("disabled", false);
                //        LockRow(Parent);
                //        RemplirListeNewTva();


                //    }
                //}
            }
            if (document.querySelector('.js-check-change').checked) {

                var index = this.cellIndex;
                var html = this.innerText;
                var Parent = this.parentNode.id;
                var locked = $("#" + Parent).attr("data-locked");

                var CELL_QTE = $("#Tableau tbody tr[id=" + Parent + "] td")[8];
                var CELL_QTELIV = $("#Tableau tbody tr[id=" + Parent + "] td")[9];
                var CELL_QTERES = $("#Tableau tbody tr[id=" + Parent + "] td")[10];
                var CELL_PUHT = $("#Tableau tbody tr[id=" + Parent + "] td")[11];
                var CELL_REMISE = $("#Tableau tbody tr[id=" + Parent + "] td")[12];
                var CELL_PTHT = $("#Tableau tbody tr[id=" + Parent + "] td")[13];
                var CELL_TVA = $("#Tableau tbody tr[id=" + Parent + "] td")[14];
                var CELL_PTTC = $("#Tableau tbody tr[id=" + Parent + "] td")[15];


                var TXT_QTE = $(CELL_QTE).html();
                var TXT_QTELIV = $(CELL_QTELIV).html();
                var TXT_QTERES = $(CELL_QTERES).html();
                var TXT_PUHT = $(CELL_PUHT).html();
                var TXT_REMISE = $(CELL_REMISE).html();
                var TXT_PTHT = $(CELL_PTHT).html();
                var TXT_TVA = $(CELL_TVA).html();
                var TXT_PTCT = $(CELL_PTTC).html();



                if (index == 8 && $(this).html().indexOf("number") < 0 && locked != "true") {
                    $(this).html("");
                    $(this).append("<input type='number' class='form-control' id='NEW_QTE' value='" + html + "' data-modif='edited'>");


                    //-----------------------------------------------------------------
                    $(CELL_PTHT).html("");
                    $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                    $(CELL_PTTC).html("");
                    $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                    $(CELL_QTELIV).html("");
                    $(CELL_QTELIV).append("<strong id='NEW_QTELIV'>" + TXT_QTELIV + "</strong>");
                    $(CELL_QTERES).html("");
                    $(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");

                    //-----------------------------------------------------------------


                    $(CELL_PUHT).html("");
                    $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");
                    $(CELL_REMISE).html("");
                    $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");

                    $(CELL_TVA).html("");
                    $(CELL_TVA).append("<select type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'></select>");
                    //-----------------------------------------------------------------

                    $("#BtnRow_" + Parent).attr("disabled", false);
                    LockRow(Parent);
                    RemplirListeNewTva();

                }

                if (index == 11 && $(this).html().indexOf("number") < 0 && locked != "true") {
                    $(this).html("");
                    $(this).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + html + "' data-modif='edited'>");
                    $(CELL_PTHT).html("");
                    $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                    $(CELL_PTTC).html("");
                    $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                    $(CELL_QTELIV).html("");
                    $(CELL_QTELIV).append("<strong id='NEW_QTELIV'>" + TXT_QTELIV + "</strong>");
                    $(CELL_QTERES).html("");
                    $(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                    //-----------------------------------------------------------------
                    $(CELL_QTE).html("");
                    $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");



                    $(CELL_REMISE).html("");
                    $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");

                    $(CELL_TVA).html("");
                    $(CELL_TVA).append("<select type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'></select>");
                    //-----------------------------------------------------------------
                    $("#BtnRow_" + Parent).attr("disabled", false);
                    LockRow(Parent);
                    RemplirListeNewTva();

                }
                if (index == 12 && $(this).html().indexOf("number") < 0 && locked != "true") {
                    $(this).html("");
                    $(this).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + html + "' data-modif='edited'>");
                    $(CELL_PTHT).html("");
                    $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                    $(CELL_PTTC).html("");
                    $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                    $(CELL_QTELIV).html("");
                    $(CELL_QTELIV).append("<strong id='NEW_QTELIV'>" + TXT_QTELIV + "</strong>");
                    $(CELL_QTERES).html("");
                    $(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");

                    //-----------------------------------------------------------------
                    $(CELL_QTE).html("");
                    $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");

                    $(CELL_PUHT).html("");
                    $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");

                    $(CELL_TVA).html("");
                    $(CELL_TVA).append("<select type='number' class='form-control' id='NEW_TVA' value='" + TXT_TVA + "' data-modif='edited'></select>");
                    //-----------------------------------------------------------------
                    $("#BtnRow_" + Parent).attr("disabled", false);
                    LockRow(Parent);
                    RemplirListeNewTva();

                }
                if (index == 14 && $(this).html().indexOf("number") < 0 && locked != "true") {
                    $(this).html("");
                    $(this).append("<select type='number' class='form-control' id='NEW_TVA' value='" + html + "' data-modif='edited'></select>");
                    $(CELL_PTHT).html("");
                    $(CELL_PTHT).append("<strong id='NEW_PTHT'>" + TXT_PTHT + "</strong>");
                    $(CELL_PTTC).html("");
                    $(CELL_PTTC).append("<strong id='NEW_PTCT'>" + TXT_PTCT + "</strong>");
                    $(CELL_QTELIV).html("");
                    $(CELL_QTELIV).append("<strong id='NEW_QTELIV'>" + TXT_QTELIV + "</strong>");
                    $(CELL_QTERES).html("");
                    $(CELL_QTERES).append("<strong id='NEW_QTERES'>" + TXT_QTERES + "</strong>");
                    //-----------------------------------------------------------------
                    $(CELL_QTE).html("");
                    $(CELL_QTE).append("<input type='number' class='form-control' id='NEW_QTE' value='" + TXT_QTE + "' data-modif='edited'>");


                    $(CELL_PUHT).html("");
                    $(CELL_PUHT).append("<input type='number' class='form-control' id='NEW_PUHT' value='" + TXT_PUHT + "' data-modif='edited'>");

                    $(CELL_REMISE).html("");
                    $(CELL_REMISE).append("<input type='number' class='form-control' id='NEW_REMISE' value='" + TXT_REMISE + "' data-modif='edited'>");
                    //-----------------------------------------------------------------
                    $("#BtnRow_" + Parent).attr("disabled", false);
                    LockRow(Parent);
                    RemplirListeNewTva();


                }
            }

        });
        //--------------------------------------------------------------------------
        function LockRow(parampassed) {
            $("#Tableau tbody tr").each(function (i, item) {
                if ($(this).attr("id") != parampassed) {
                    $(this).attr("data-locked", true);
                }
            });
        }
        //--------------------------------------------------------------------------
        function RemplirListe13() {

            $('#TVASERVICE').append($('<option>', {
                value: "",
                text: ""
            }));


            $.ajax({
                type: 'POST',
                url: "/Vente/GetAllTVA",
                success: function (response) {
                    $.each(response, function (i, item) {
                        $('#TVASERVICE').append($('<option>', {
                            value: item.Valeur_TVA,
                            text: item.Valeur_TVA
                        }));
                    });
                }
            });
        }
        function RemplirListe12() {
            $('#RESSOURCE').append($('<option>', {
                value: "",
                text: ""
            }));
            $.ajax({
                type: 'POST',
                url: "/Vente/GetAllRESSOURCE",
                success: function (response) {
                    $.each(response, function (i, item) {
                        $('#RESSOURCE').append($('<option>', {
                            value: item.PersonnelId,
                            text: item.Nom
                        }));
                    });
                }
            });
        }
        function RemplirListe11() {
            $('#SERVICE').append($('<option>', {
                value: "",
                text: ""
            }));


            $.ajax({
                type: 'POST',
                url: "/Vente/GetAllSERVICE",
                success: function (response) {
                    $.each(response, function (i, item) {
                        $('#SERVICE').append($('<option>', {
                            value: item.ID,
                            text: item.REF
                        }));
                    });
                }
            });
        }
        function RemplirListe() {
            $('#articles').find('option').remove();
            $('#articles').append($('<option>', {
                value: "0",
                text: ""
            }));
            $.ajax({
                type: 'POST',
                url: "/Vente/GetAllProduct",
                success: function (response) {
                    $.each(response, function (i, item) {
                        $('#articles').append($('<option>', {
                            value: item.ID,
                            text: item.Libelle_Prd
                        }));
                    });
                }
            });
        }
        //--------------------------------------------------------------------------
        function RemplirListe2() {

            $('#TVAProduit').find('option').remove();
            $('#TVAProduit').append($('<option>', {
                value: "0",
                text: ""
            }));


            $.ajax({
                type: 'POST',
                url: "/Vente/GetAllTVA",
                success: function (response) {
                    $.each(response, function (i, item) {
                        $('#TVAProduit').append($('<option>', {
                            value: item.Valeur_TVA,
                            text: item.Valeur_TVA
                        }));
                    });
                }
            });
        }
        //------------------------------------------------------------------------------------------
        function RemplirListe3() {
            $('#marque').find('option').remove();
            $('#marque').append($('<option>', {
                value: "0",
                text: ""
            }));

            $.ajax({
                type: 'POST',
                url: "/Vente/GetAllMarque",
                success: function (response) {
                    $.each(response, function (i, item) {
                        $('#marque').append($('<option>', {
                            value: item.Nom_marque,
                            text: item.Nom_marque
                        }));
                    });
                }
            });
        }
        //--------------------------------------------------------------------------
        function RemplirListe4() {
            $('#unite').append($('<option>', {
                value: "",
                text: ""
            }));

            $.ajax({
                type: 'POST',
                url: "/Vente/GetAllUnite",
                success: function (response) {

                    $.each(response, function (i, item) {
                        $('#unite').append($('<option>', {
                            value: item.Valeur_Unite,
                            text: item.Valeur_Unite

                        }));

                    });
                }
            });
        }
        //--------------------------------------------------------------------------
        function RemplirListe5() {
            $('#devise').append($('<option>', {
                value: "",
                text: ""
            }));

            $.ajax({
                type: 'POST',
                url: "/Vente/GetAllDevise",
                success: function (response) {

                    $.each(response, function (i, item) {
                        $('#devise').append($('<option>', {
                            value: item.Nom_Devise,
                            text: item.Nom_Devise

                        }));

                    });
                }
            });
        }
        //--------------------------------------------------------------------------------------
        function RemplirListe6() {
            $('#categorie').find('option').remove();
            $('#categorie').append($('<option>', {
                value: "0",
                text: ""
            }));

            $.ajax({
                type: 'POST',
                url: "/Vente/GetAllCategorie",
                success: function (response) {
                    $.each(response, function (i, item) {
                        $('#categorie').append($('<option>', {
                            value: item.CentreID,
                            text: item.Libelle
                        }));
                    });
                }
            });
        }
        //--------------------------------------------------------------------------
        function RemplirListeNewTva() {

            $('#NEW_TVA').find('option').remove();
            $('#NEW_TVA').append($('<option>', {
                value: "0",
                text: ""
            }));


            $.ajax({
                type: 'POST',
                url: "/Vente/GetAllTVA",
                success: function (response) {
                    $.each(response, function (i, item) {
                        $('#NEW_TVA').append($('<option>', {
                            value: item.Valeur_TVA,
                            text: item.Valeur_TVA
                        }));
                    });
                }
            });
        }
        //--------------------------------------------------------------------------
        $(document).on("change", "#articles", function (e) {
            $('#descriptionProduit').val("");
            $('#marque').val("");
            $('#unite').val("");
            $('#devise').val("");
            $('#categorie').val("");
            $('#Sous_Categorie').val("");
            $('#StockProduit').val("");
            $('#PUHTProduit').val("");
            $('#TVAProduit').val("");
            $('#PTHTProduit').val("");
            $('#TTCProduit').val("");
            $.ajax({
                type: 'POST',
                url: "/Vente/GetProductByID?ID=" + this.value,
                success: function (response) {

                    $('#descriptionProduit').val(response.Designation);
                    $('#marque').val(response.Marque);
                    $('#unite').val(response.Unite);
                    $('#devise').val(response.Devise);
                    $('#categorie').val(response.Categorie);
                    var selectedItemValue = $('#categorie').val();

                    var ddlProducts = $("#Sous_Categorie");
                    $.ajax({
                        cache: false,
                        type: "GET",
                        url: '@Url.Action("GetsousByCategoryId", "Vente")',
                        data: { "id": selectedItemValue },
                        success: function (data) {
                            ddlProducts.html('');
                            $.each(data, function (id, option) {
                                ddlProducts.append($('<option></option>').val(option.id).html(option.name));
                            });
                        },
                        error: function (xhr, ajaxOptions, thrownError) {
                            alert('Found error to load product!!.');
                        }
                    });
                    $('#StockProduit').val(response.Stock);
                    $('#PUHTProduit').val(response.PU_HT_Sans_Remise);
                    $('#TVAProduit').val(response.Valeur_TVA);

                    $('#PTHTProduit').val(response.PU_HT_Avec_Remise);
                    //var TVA = $('#TVAProduit').val();
                    //TVA = parseFloat(TVA);
                    //var MontantTVA = (PTHTProduit * TVA) / 100;
                    //var TTCProduit = PTHTProduit + MontantTVA;
                    //$('#TTCProduit').val(TTCProduit);
                    $('#TTCProduit').val(response.PU_TTC);
                    var MaxQuantite = $("#StockProduit").val();
                    MaxQuantite = parseInt(MaxQuantite);
                    if (MaxQuantite > 0) {
                        $("#QuantiteProduit").attr("max", MaxQuantite);
                    }
                }
            });
            $('#FirstBTN').attr("disabled", false);
        });
        //--------------------------------------------------------------------------
        $('#client').on('change', function () {
            $("#codeClient").val("");
            if (this.value != "") {
                $.ajax({
                    type: 'POST',
                    url: "/Vente/GetClientByID?ID=" + this.value,
                    success: function (response) {
                        $("#codeClient").val(response.CODE);
                    }
                });
            }
        });
        //--------------------------------------------------------------------------
        $(document).on("keyup", "#remise", function (e) {
            var remise = $("#remise").val();
            var totalHT = $("#totalHT").val();
            var totalTVA = window.totalTVA;
            totalHT = parseFloat(totalHT);
            totalTVA = parseFloat(totalTVA);
            var NewTotalTva = totalTVA - ((totalTVA * remise) / 100);
            NewTotalTva = parseFloat(NewTotalTva);
            $("#totalTVA").val(NewTotalTva.toFixed(3));
            var NetHT = totalHT - ((totalHT * remise) / 100);
            NetHT = parseFloat(NetHT);
            $("#NetHT").val(NetHT.toFixed(3));
            var TotalTTC = NetHT + NewTotalTva;
            $("#TotalTTC").val(TotalTTC.toFixed(3));
            $("#netAPaye").val(TotalTTC.toFixed(3));
        });
        //--------------------------------------------------------------------------
        function AddRow2() {
            var ID_Produit = $("#SERVICE").val();
            var LIB_Produi = $("#SERVICE option:selected").text();
            var Description_Produit = $('#descriptionSERVICE').val();
            var unite = $('#uniteSERVICE').val();
            var Quantite_Produit = $('#QuantiteSERVICE').val();
            var PUHT_Produit = $('#PUHTSERVICE').val();
            var Remise_Produit = $('#RemiseSERVICE').val();
            var PTHT_Produit = $('#PTHTSERVICE').val();
            var TVA_Produit = $("#TVASERVICE option:selected").text();
            var TTC_Produit = $('#TTCSERVICE').val();
            var RESSOURCE = $("#RESSOURCE").val();
            var RESSOURCE2 = $("#RESSOURCE option:selected").text();


            var data1 = {
                ID_Produit: ID_Produit,
                LIB_Produi: LIB_Produi,
                Description_Produit: Description_Produit,
                unite: unite,
                Quantite_Produit: Quantite_Produit,
                PUHT_Produit: PUHT_Produit,
                Remise_Produit: Remise_Produit,
                PTHT_Produit: PTHT_Produit,
                TVA_Produit: TVA_Produit,
                TTC_Produit: TTC_Produit,
                RESSOURCE: RESSOURCE,
                RESSOURCE2: RESSOURCE2,

            };


            $.ajax({
                type: 'POST',
                url: "/Vente/AddLineSERVICE",
                data: data1,
                success: function (response) {
                    RemplirTableau4();

                }
            });
        }
        function AddRow() {
            var Quantite_Produit = $('#QuantiteProduit').val();
            var Quantite_Liv = $('#QuantiteLiv').val();
            Quantite_Produit1 = parseInt(Quantite_Produit);
            Quantite_Liv1 = parseInt(Quantite_Liv);
            if (Quantite_Liv1 > Quantite_Produit1) {
                alert("Quantité livré est dépassé la quantité commandé");
            }
            else {
                var ID_Produit = $('#articles').val();
                var LIB_Produi = $("#articles option:selected").text();
                var Description_Produit = $('#descriptionProduit').val();
                var marque = $("#marque option:selected").text();
                var unite = $("#unite option:selected").text();
                var devise = $("#devise option:selected").text();
                var categorie = $("#categorie option:selected").text();
                var sous_categorie = $("#Sous_Categorie option:selected").text();
                //var StockProduit = $("#StockProduit").val();
                //var Quantite_Produit = $('#QuantiteProduit').val();
                //var Quantite_Liv = $('#QuantiteLiv').val();
                var Quantite_Res = $('#QuantiteRes').val();
                var PUHT_Produit = $('#PUHTProduit').val();
                var Remise_Produit = $('#RemiseProduit').val();
                var PTHT_Produit = $('#PTHTProduit').val();
                var TVA_Produit = $('#TVAProduit').val();
                var TTC_Produit = $('#TTCProduit').val();
                var data = {
                    ID_Produit: ID_Produit,
                    LIB_Produi: LIB_Produi,
                    Description_Produit: Description_Produit,
                    marque: marque,
                    unite: unite,
                    devise: devise,
                    categorie: categorie,
                    sous_categorie: sous_categorie,
                    StockProduit: StockProduit,
                    Quantite_Produit: Quantite_Produit,
                    Quantite_Liv: Quantite_Liv,
                    Quantite_Res: Quantite_Res,
                    PUHT_Produit: PUHT_Produit,
                    Remise_Produit: Remise_Produit,
                    PTHT_Produit: PTHT_Produit,
                    TVA_Produit: TVA_Produit,
                    TTC_Produit: TTC_Produit
                };
                $.ajax({
                    type: 'POST',
                    url: "/Vente/AddLineBonLivraison",
                    data: data,
                    success: function (response) {
                        RemplirTableau();
                    }
                });
            }
        }
        //--------------------------------------------------------------------------
        function RemplirTableau4() {
            $("#Tab tbody").empty();

            $.ajax({
                type: 'POST',
                url: "/Vente/GetAllLinSERVICE",
                success: function (response1) {

                    $.each(response1, function (i, item) {


                        var line = "<tr id='" + item.ID + "'><td>" + item.REFSERVICE + "</td><td>" + item.DescriptionSERVICE + "</td><td>" + item.UNITE + "</td><td>" + item.QUANTITE + "</td><td>" + item.PRIX_VENTE_HT + "</td><td>" + item.REMISE + "</td><td>" + item.PTHT + "</td><td>" + item.TVA + "</td><td>" + item.TTC + "</td><td>" + item.RESSOURCE2 + "</td><td style='display: flex; border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px;'> <button class='btn btn-info btn-circle' type='button' onclick='EditRow(\"" + item.ID + "\")' disabled id='BtnRow_" + item.ID + "'> <i class='fa fa-check'></i> </button> <button class='btn btn-warning btn-circle' type='button' onclick='DeleteRow2(\"" + item.ID + "\")'> <i class='fa fa-times'></i> </button> </td></tr>";
                        $("#Tab tbody").append(line);


                    });
                    if (Mode == "Aff") {
                        $("#Tab tfoot").empty();
                    }
                    else {
                        $("#Tab tfoot").replaceWith("<tfoot><tr><tr><td><select type='text' class='form-control' id='SERVICE'/></td><td><textarea id='descriptionSERVICE'></textarea></td><td><input class='form-control' id='uniteSERVICE' value='H'/></td><td><input type='number' class='form-control' id='QuantiteSERVICE' value='1' min='1'/></td><td><input type='number' class='form-control' id='PUHTSERVICE' min='0' /></td><td><input type='number' class='form-control' id='RemiseSERVICE' value='0' min='0'/></td><td><input type='number' class='form-control' id='PTHTSERVICE' readonly='true'/></td><td><select class='form-control' id='TVASERVICE'><option>19</option></select></td><td><input type='number' class='form-control' id='TTCSERVICE' readonly='true'/></td><td><select type='text' id='RESSOURCE' data-placeholder='Choose a Country...' class='chosen-select' multiple style='width:350px;' tabindex='4'></select></td><td style='display: flex; border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px;'> <button class='btn btn-info btn-circle' type='button' onclick='AddRow2()'  id='FirstBTN'> <i class='fa fa-check'></i> </button> <button class='btn btn-warning btn-circle' type='button' disabled> <i class='fa fa-times'></i> </button> </td> </tr> </tfoot>");
                        $("#SERVICE").select2();
                        $("#RESSOURCE").select2();
                        $("#TVASERVICE").select2();
                        RemplirListe11();
                        RemplirListe12();
                        RemplirListe13();
                    }

                }
            });

            UpdatePrice();

        }
        function RemplirTableau() {
            $("#Tableau tbody").empty();
            if (document.querySelector('.js-check-change').checked) {
                $.ajax({
                    type: 'POST',
                    url: "/Vente/GetAllLineBonLivraisonTotal",
                    success: function (response) {
                        $.each(response, function (i, item) {
                            //var Qte = item.QUANTITE;
                            //var QteRes = 0;
                            //var PRIX_VENTE_HT = item.PRIX_VENTE_HT;
                            //var PrixTotHTSansRemise = Qte * PRIX_VENTE_HT;
                            //var Remise = item.REMISE;
                            //Remise = parseFloat(Remise);
                            //var MontantRemise = (PrixTotHTSansRemise * Remise) / 100;
                            //var PTHTProduit = PrixTotHTSansRemise - MontantRemise;
                            ////$('#PTHTProduit').val(PTHTProduit.toFixed(3));
                            //var TVA = $('#TVAProduit').val();
                            //TVA = parseFloat(TVA);
                            //var MontantTVA = (PTHTProduit * TVA) / 100;
                            //var TTCProduit = PTHTProduit + MontantTVA;
                            //$('#TTCProduit').val(TTCProduit.toFixed(3));
                            var line = "<tr id='" + item.ID + "'><td>" + item.LIBELLE + "</td><td>" + item.DESIGNATION + "</td><td>" + item.MARQUE + "</td><td>" + item.UNITE + "</td><td>" + item.DEVISE + "</td><td>" + item.CATEGORIE + "</td><td>" + item.Sous_CATEGORIE + "</td><td>" + item.STOCK + "</td><td>" + item.QUANTITE + "</td><td>" + item.QUANTITELiv + "</td><td>" + item.QUANTITERES + "</td><td>" + item.PRIX_VENTE_HT + "</td><td>" + item.REMISE + "</td><td>" + item.PTHT + "</td><td>" + item.TVA + "</td><td>" + item.TTC + "</td><td style='display: flex; border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px;'> <button class='btn btn-info btn-circle' type='button' onclick='EditRowBt(\"" + item.ID + "\")' disabled id='BtnRow_" + item.ID + "'> <i class='fa fa-check'></i> </button> <button class='btn btn-warning btn-circle' type='button' onclick='DeleteRow(\"" + item.ID + "\")'> <i class='fa fa-times'></i> </button> </td></tr>";
                            $("#Tableau tbody").append(line);
                        });
                        //$("#Tableau tfoot").empty();
                        $("#Tableau tfoot").replaceWith("<tfoot> <tr> <td> <select class='form-control' id='articles'> </select> </td> <td><textarea name='descriptionProduit' id='descriptionProduit'></textarea ></td><td> <select class='form-control' id='marque'> </select> </td><td> <select class='form-control' id='unite'> </select> </td><td> <select class='form-control' id='devise'> </select> </td><td> <select class='form-control' id='categorie'> </select> </td><td> <select class='form-control' name='Sous_Categorie' id='Sous_Categorie'> </select> </td><td> <input type='text' class='form-control' id='StockProduit' readonly='true' /> </td> <td> <input type='number' class='form-control' id='QuantiteProduit' value='1' min='1'/> </td><td> <input type='number' class='form-control' id='QuantiteLiv' value='0' min='1' disabled/> </td> <td> <input type='number' class='form-control' id='QuantiteRes' disabled value='0' min='0'/> </td><td> <input type='number' class='form-control' id='PUHTProduit' min='0'/> </td> <td> <input type='number' class='form-control' id='RemiseProduit' value='0' min='0' /> </td> <td> <input type='number' class='form-control' id='PTHTProduit' readonly='true' /> </td> <td> <select class='form-control' id='TVAProduit'></select> </td> <td> <input type='number' class='form-control' id='TTCProduit' readonly='true' /> </td> <td style='display: flex; border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px;'> <button class='btn btn-info btn-circle' type='button' onclick='AddRow()'> <i class='fa fa-check'></i> </button> <button class='btn btn-warning btn-circle' type='button' disabled> <i class='fa fa-times'></i> </button> </td> </tr> </tfoot>");
                        var MaxQuantite = $("#StockProduit").val();
                        MaxQuantite = parseInt(MaxQuantite);
                        if (MaxQuantite > 0) {
                            $("#QuantiteProduit").attr("max", MaxQuantite);
                        }
                        RemplirListe();
                        RemplirListe2();
                        RemplirListe3();
                        RemplirListe4();
                        RemplirListe5();
                        RemplirListe6();
                    }
                });

            }
            if (document.querySelector('.js-check-change').checked == false) {

                $.ajax({
                    type: 'POST',
                    url: "/Vente/GetAllLineBonLivraison",
                    success: function (response) {
                        $.each(response, function (i, item) {

                            var line = "<tr id='" + item.ID + "'><td>" + item.LIBELLE + "</td><td>" + item.DESIGNATION + "</td><td>" + item.MARQUE + "</td><td>" + item.UNITE + "</td><td>" + item.DEVISE + "</td><td>" + item.CATEGORIE + "</td><td>" + item.Sous_CATEGORIE + "</td><td>" + item.STOCK + "</td><td>" + item.QUANTITE + "</td><td>" + item.QUANTITELiv + "</td><td>" + item.QUANTITERES + "</td><td>" + item.PRIX_VENTE_HT + "</td><td>" + item.REMISE + "</td><td>" + item.PTHT + "</td><td>" + item.TVA + "</td><td>" + item.TTC + "</td><td style='display: flex; border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px;'> <button class='btn btn-info btn-circle' type='button' onclick='EditRow(\"" + item.ID + "\")' disabled id='BtnRow_" + item.ID + "'> <i class='fa fa-check'></i> </button> <button class='btn btn-warning btn-circle' type='button' onclick='DeleteRow(\"" + item.ID + "\")'> <i class='fa fa-times'></i> </button> </td></tr>";
                            $("#Tableau tbody").append(line);
                        });
                        $("#Tableau tfoot").replaceWith("<tfoot> <tr> <td> <select class='form-control' id='articles'> </select> </td> <td><textarea name='descriptionProduit' id='descriptionProduit'></textarea ></td><td> <select class='form-control' id='marque'> </select> </td><td> <select class='form-control' id='unite'> </select> </td><td> <select class='form-control' id='devise'> </select> </td><td> <select class='form-control' id='categorie'> </select> </td><td> <select class='form-control' name='Sous_Categorie' id='Sous_Categorie'> </select> </td><td> <input type='text' class='form-control' id='StockProduit' readonly='true' /> </td> <td> <input type='number' class='form-control' id='QuantiteProduit' value='1' min='1'/> </td><td> <input type='number' class='form-control' id='QuantiteLiv'  min='0'/> </td> <td> <input type='number' class='form-control' id='QuantiteRes' disabled value='0' min='0'/> </td>   <td> <input type='number' class='form-control' id='PUHTProduit' min='0'/> </td> <td> <input type='number' class='form-control' id='RemiseProduit' value='0' min='0' /> </td> <td> <input type='number' class='form-control' id='PTHTProduit' readonly='true' /> </td> <td> <select class='form-control' id='TVAProduit'></select> </td> <td> <input type='number' class='form-control' id='TTCProduit' readonly='true' /> </td> <td style='display: flex; border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px;'> <button class='btn btn-info btn-circle' type='button' onclick='AddRow()'> <i class='fa fa-check'></i> </button> <button class='btn btn-warning btn-circle' type='button' disabled> <i class='fa fa-times'></i> </button> </td> </tr> </tfoot>");
                        var MaxQuantite = $("#StockProduit").val();
                        MaxQuantite = parseInt(MaxQuantite);
                        if (MaxQuantite > 0) {
                            $("#QuantiteProduit").attr("max", MaxQuantite);
                        }
                        RemplirListe();
                        RemplirListe2();
                        RemplirListe3();
                        RemplirListe4();
                        RemplirListe5();
                        RemplirListe6();
                    }
                });
            }
            if (Mode == "Create") {
                UpdatePrice();
            }

        }
        //--------------------------------------------------------------------------
        function RemplirTableau1() {

            $("#Tableau tbody").empty();
            $.ajax({
                type: 'POST',
                url: "/Vente/GetAllLineBonLivraisonTotal",
                success: function (response) {
                    $.each(response, function (i, item) {

                        var line = "<tr id='" + item.ID + "'><td>" + item.LIBELLE + "</td><td>" + item.DESIGNATION + "</td><td>" + item.MARQUE + "</td><td>" + item.UNITE + "</td><td>" + item.DEVISE + "</td><td>" + item.CATEGORIE + "</td><td>" + item.Sous_CATEGORIE + "</td><td>" + item.STOCK + "</td><td>" + item.QUANTITE + "</td><td>" + item.QUANTITELiv + "</td><td>" + item.QUANTITERES + "</td><td>" + item.PRIX_VENTE_HT + "</td><td>" + item.REMISE + "</td><td>" + item.PTHT + "</td><td>" + item.TVA + "</td><td>" + item.TTC + "</td><td style='display: flex; border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px;'> <button class='btn btn-info btn-circle' type='button' onclick='EditRow(\"" + item.ID + "\")' disabled id='BtnRow_" + item.ID + "'> <i class='fa fa-check'></i> </button> <button class='btn btn-warning btn-circle' type='button' onclick='DeleteRow(\"" + item.ID + "\")'> <i class='fa fa-times'></i> </button> </td></tr>";
                        $("#Tableau tbody").append(line);
                    });
                    $("#Tableau tfoot").empty();
                    var MaxQuantite = $("#StockProduit").val();
                    MaxQuantite = parseInt(MaxQuantite);
                    if (MaxQuantite > 0) {
                        $("#QuantiteProduit").attr("max", MaxQuantite);
                    }
                    //RemplirListe();
                    //RemplirListe2();
                    //RemplirListe3();
                    //RemplirListe4();
                    //RemplirListe5();
                    //RemplirListe6();
                }
            });
        }
        //---------------------------------------------------------------------------
        function EditRow(parampassed) {

            var ID_Produit = parampassed;
            var Quantite_Produit = $('#NEW_QTE').text();
            if (Quantite_Produit == "") {
                var Quantite_Produit = $('#NEW_QTE').val();
                var Quantite_Liv = $('#NEW_QTELIV').text();
                var Quantite_Res = $('#NEW_QTERES').text();
                var PUHT_Produit = $('#NEW_PUHT').val();
                var Remise_Produit = $('#NEW_REMISE').val();
                var PTHT_Produit = $('#NEW_PTHT').text();
                var TVA_Produit = $('#NEW_TVA').val();
                var TTC_Produit = $('#NEW_PTCT').text();
            }
            else
            {
                var Quantite_Liv = $('#NEW_QTELIV').val();
                var Quantite_Res = $('#NEW_QTERES').text();
                var PUHT_Produit = $('#NEW_PUHT').text();
                var Remise_Produit = $('#NEW_REMISE').text();
                var PTHT_Produit = $('#NEW_PTHT').text();
                var TVA_Produit = $('#NEW_TVA').text();
                var TTC_Produit = $('#NEW_PTCT').text();
            }
            var Mode = "@ViewBag.Mode";
            var data = {
                ID_Produit: ID_Produit,
                Quantite_Produit: Quantite_Produit,
                Quantite_Liv: Quantite_Liv,
                Quantite_Res: Quantite_Res,
                Mode: Mode,
                PUHT_Produit: PUHT_Produit,
                Remise_Produit: Remise_Produit,
                PTHT_Produit: PTHT_Produit,
                TVA_Produit: TVA_Produit,
                TTC_Produit: TTC_Produit
            };


            $.ajax({
                type: 'POST',
                data: data,
                url: "/Vente/EditLineBonLivraison",
                success: function (response) {

                    RemplirTableau();
                }
            });

        }
        function EditRowBt(parampassed) {


            var ID_Produit = parampassed;
            var Quantite_Produit = $('#NEW_QTE').val();
            var Quantite_Liv = $('#NEW_QTELIV').text();
            var Quantite_Res = $('#NEW_QTERES').text();
            var PUHT_Produit = $('#NEW_PUHT').val();
            var Remise_Produit = $('#NEW_REMISE').val();
            var PTHT_Produit = $('#NEW_PTHT').text();
            var TVA_Produit = $('#NEW_TVA').val();
            var TTC_Produit = $('#NEW_PTCT').text();

            var data = {
                ID_Produit: ID_Produit,
                Quantite_Produit: Quantite_Produit,
                Quantite_Liv: Quantite_Liv,
                Quantite_Res: Quantite_Res,
                PUHT_Produit: PUHT_Produit,
                Remise_Produit: Remise_Produit,
                PTHT_Produit: PTHT_Produit,
                TVA_Produit: TVA_Produit,
                TTC_Produit: TTC_Produit
            };


            $.ajax({
                type: 'POST',
                data: data,
                url: "/Vente/EditLineBonLivraisonbt",
                success: function (response) {

                    RemplirTableau();
                }
            });

        }

        //---------------------------------------------------------------------------
        function DeleteRow(parampassed) {
            $.ajax({
                type: 'POST',
                url: "/Vente/DeleteLineBonLivraison?parampassed=" + parampassed,
                success: function (response) {
                    RemplirTableau();
                }
            });
        }
        function DeleteRow2(parampassed) {
            $.ajax({
                type: 'POST',
                url: "/Vente/DeleteLineService?parampassed=" + parampassed,
                success: function (response) {
                    RemplirTableau4();
                }
            });
        }
        //---------------------------------------------------------------------------
        function UpdatePrice() {
            var remise = $("#remise").val();
            $.ajax({
                type: 'POST',
                url: "/Vente/UpdatePriceBonLivraison?remise=" + remise,
                success: function (response) {
                    var totalHT = response.totalHT;
                    var totalTVA = response.totalTVA;
                    window.totalTVA = totalTVA;

                    var totalHTSERV = response.totalHTSERV;
                    var totalTVASERV = response.totalTVASERV;
                    window.totalTVASERV = totalTVASERV;
                    totalHTSERV = parseFloat(totalHTSERV);
                    totalTVASERV = parseFloat(totalTVASERV);

                    totalHT = parseFloat(totalHT) + totalHTSERV;
                    totalTVA = parseFloat(totalTVA) + totalTVASERV;
                    
                    $("#totalHT").val(totalHT.toFixed(3));
                    var NewTotalTva = totalTVA - ((totalTVA * remise) / 100);
                    NewTotalTva = parseFloat(NewTotalTva);

                    var NEWtotalTVASERV = totalTVASERV - ((totalTVASERV * remise) / 100);
                    NEWtotalTVASERV = parseFloat(NEWtotalTVASERV);
                    var NettotalHTSERV = totalHTSERV - ((totalHTSERV * remise) / 100);
                    NettotalHTSERV = parseFloat(NettotalHTSERV);

                    $("#totalTVA").val(NewTotalTva.toFixed(3));
                    var NetHT = totalHT - ((totalHT * remise) / 100);
                    NetHT = parseFloat(NetHT);
                    $("#NetHT").val(NetHT);
                    var NettotalTTCSERV = NEWtotalTVASERV + NettotalHTSERV;

                    var TotalTTC = NetHT + NewTotalTva;
                    $("#TotalTTC").val(TotalTTC.toFixed(3));
                    $("#NettotalTTCSERV").val(NettotalTTCSERV.toFixed(3));

                    $("#netAPaye").val(TotalTTC.toFixed(3));
                }
            });
        }
        //---------------------------------------------------------------------------
        $("#PrintBTN").click(function () {
            $("#WithPrint").val("true");
            $("form").attr("target", "_blank");
            $("form").submit();
            $("#WithPrint").val("false");
            $("form").attr("target", "_self");
        });
        //---------------------------------------------------------------------------
        $("#DeleteBtn").click(function () {
            Delete();
        });
        function Delete() {
            var parampassed = "@ViewBag.Code";
            var Conf = confirm("Voulez vous Supprimer cet elément ?");
            if (Conf == true) {
                $.ajax({
                    type: 'POST',
                    url: "/Vente/DeleteBonLaivraison?parampassed=" + parampassed,
                    success: function (response) {
                        window.location = "/Vente/Commandes";
                    }
                });
            }
            var preloader = $('<div>', { 'class': 'preloader' }).appendTo('body');
            $(this)
                   .ajaxStart(function () {
                       preloader.fadeIn();
                   })
                   .ajaxStop(function () {
                       preloader.delay(800).fadeOut();
                   });
        }
        //---------------------------------------------------------------------------
        $('form').validate({
            rules: {
                client: {
                    required: true
                }
            }
        });
        //--------------------------------------------------------------------------------
        $("#ValidateBtn").click(function () {
            Validate();
        });
        function Validate() {
            var parampassed = "@ViewBag.Code";
            var type = $("#type").val();
            var Conf = confirm("Voulez vous Valider ce bon de livraison partiel ?");
            if (Conf == true) {
                $.ajax({
                    type: 'POST',
                    url: "/Vente/validateBonLivraisonPar?parampassed=" + parampassed,
                    success: function (response) {
                        if (response == "NO") {
                            alert("stock insuffisant");
                            
                        }
                        else {
                            window.location = "/Vente/BonLivraisonPartiel";
                        }
                    }
                });
            }
            var preloader = $('<div>', { 'class': 'preloader' }).appendTo('body');
            $(this)
                   .ajaxStart(function () {
                       preloader.fadeIn();
                   })
                   .ajaxStop(function () {
                       preloader.delay(800).fadeOut();
                   });
        }
        //-----------------------------------------------------------------------------
        //$(document).on("keyup", "#QteLiv", function (e) {
        //    debugger;
        //    var QteLiv = $("#QteLiv").val();
        //    var QuantiteProduit = $("#QuantiteProduit").val();
        //    QteLiv = parseInt(QteLiv);
        //    QuantiteProduit = parseInt(QuantiteProduit);
        //    if (QteLiv > QuantiteProduit) {
        //        alert("hhhhh");
        //    }


        //});
        //--------------------------------------------------------------------------------
        $("#VersFacture").click(function () {
            VersFacture();
        });
        function VersFacture() {
            var parampassed = "@ViewBag.Code";
            var Conf = confirm("Voulez vous transformer ce bon de livraison en facture ?");
            if (Conf == true) {
                $.ajax({
                    type: 'POST',
                    url: "/Vente/BonLivraisonPartVersfacture?parampassed=" + parampassed,
                    success: function (response) {
                        if (response == "NO") {
                            window.location.href = window.location.href;
                            alert("Bon de livraison pas encore validée");
                        }
                        else {
                            window.location.href = "/Vente/FormFacture?Mode=Edit&Code=" + response;
                        }
                    }
                });
            }
            var preloader = $('<div>', { 'class': 'preloader' }).appendTo('body');
            $(this)
                   .ajaxStart(function () {
                       preloader.fadeIn();
                   })
                   .ajaxStop(function () {
                       preloader.delay(800).fadeOut();
                   });
        }
         $("#VersCaisse").click(function () {
            VersCaisse();
        });
        function VersCaisse() {
            var parampassed = "@ViewBag.Code";
            var Conf = confirm("Voulez vous transformer ce bon de livraison en Caisse Noir ?");
            if (Conf == true) {
                $.ajax({
                    type: 'POST',
                    url: "/Vente/BonLivraisonParVersCaisse?parampassed=" + parampassed,
                    success: function (response) {
                        if (response == "NO") {
                            window.location.href = window.location.href;
                            alert("Bon de livraison pas encore validée");
                        }
                        else {
                            window.location.href = "/Vente/FormCaisse?Mode=Edit&Code=" + response;
                        }
                    }
                });
            }
            var preloader = $('<div>', { 'class': 'preloader' }).appendTo('body');
            $(this)
                   .ajaxStart(function () {
                       preloader.fadeIn();
                   })
                   .ajaxStop(function () {
                       preloader.delay(800).fadeOut();
                   });
        }

        var config = {
            '.chosen-select': {},
            '.chosen-select-deselect': { allow_single_deselect: true },
            '.chosen-select-no-single': { disable_search_threshold: 10 },
            '.chosen-select-no-results': { no_results_text: 'Oops, nothing found!' },
            '.chosen-select-width': { width: "95%" }
        }
        for (var selector in config) {
            $(selector).chosen(config[selector]);
        }

        function decodeHtml(html) {
            var txt = document.createElement("textarea");
            txt.innerHTML = html;
            return txt.value;
        }
    </script>
}